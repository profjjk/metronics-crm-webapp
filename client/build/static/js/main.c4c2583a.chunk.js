(this.webpackJsonpmetronics=this.webpackJsonpmetronics||[]).push([[0],{106:function(e,t,s){},107:function(e,t,s){},108:function(e,t,s){},109:function(e,t,s){},110:function(e,t,s){},111:function(e,t,s){},112:function(e,t,s){"use strict";s.r(t);var c=s(1),r=s.n(c),a=s(37),n=s.n(a),i=s(63),u=s(3),o=s(5),l=s.n(o),d=s(9),j=s(11),b=s.n(j),m=function(){return JSON.parse(localStorage.getItem("metronics"))},h=function(){localStorage.removeItem("metronics")},O="https://metronics-webapp-server.herokuapp.com/api",x="".concat(O,"/customers"),f="".concat(O,"/jobs"),p="".concat(O,"/parts"),v="".concat(O,"/messages"),y="".concat(O,"/requests"),N="".concat(O,"/users"),g="".concat(O,"/auth"),w=function(){var e=m().token;if(e)return{metronics:e}},C={getCustomers:function(){return b.a.get(x,{headers:w()})},createCustomer:function(e){return b.a.post(x,e,{headers:w()})},updateCustomer:function(e,t){return b.a.put("".concat(x,"/").concat(e),t,{headers:w()})},deleteCustomer:function(e){return b.a.delete("".concat(x,"/").concat(e),{headers:w()})},getJobs:function(){return b.a.get(f,{headers:w()})},createJob:function(e){return b.a.post(f,e,{headers:w()})},updateJob:function(e,t){return b.a.put("".concat(f,"/").concat(e),t,{headers:w()})},deleteJob:function(e){return b.a.delete("".concat(f,"/").concat(e),{headers:w()})},deleteJobsByCustomerId:function(e){return b.a.delete("".concat(f,"/clear/").concat(e),{headers:w()})},getParts:function(){return b.a.get(p,{headers:w()})},createPart:function(e){return b.a.post(p,e,{headers:w()})},updatePart:function(e,t){return b.a.put("".concat(p,"/").concat(e),t,{headers:w()})},deletePart:function(e){return b.a.delete("".concat(p,"/").concat(e),{headers:w()})},getMessages:function(){return b.a.get(v,{headers:w()})},updateMessage:function(e,t){return b.a.put("".concat(v,"/").concat(e),t,{headers:w()})},deleteMessage:function(e){return b.a.delete("".concat(v,"/").concat(e),{headers:w()})},getRequests:function(){return b.a.get(y,{headers:w()})},deleteRequest:function(e){return b.a.delete("".concat(y,"/").concat(e),{headers:w()})},getUser:function(e){return b.a.get("".concat(N,"/").concat(e),{headers:w()})},updateUser:function(e,t){return b.a.put("".concat(N,"/").concat(e),t,{headers:w()})},deleteUser:function(e){return b.a.delete("".concat(N,"/").concat(e),{headers:w()})},login:function(e){return b.a.post("".concat(g,"/login"),e)},register:function(e){return b.a.post("".concat(g,"/register"),e,{headers:w()})}},D=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.getCustomers();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0.message),window.location.reload();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),Q=function(){return Object(u.useQuery)("customers",(function(){return D()}))},k=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.getJobs();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0.message),window.location.reload();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),S=function(){return Object(u.useQuery)("jobs",(function(){return k()}))},F=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.getParts();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0.message),window.location.reload();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),q=function(){return Object(u.useQuery)("parts",(function(){return F()}))},L=s(6),P=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.getUser(t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),h(),console.error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(u.useQueryClient)(),t=Object(c.useState)(m()),s=Object(L.a)(t,2),r=s[0],a=s[1];Object(u.useQuery)("user",(function(){return P(r._id)}),{enabled:!!r,onSuccess:function(e){a({_id:e.data._id,username:e.data.username})}});return{user:r,updateUser:function(t){a({_id:t._id,username:t.username}),e.setQueryData("user",r)},clearUser:function(){a(null),e.setQueryData("user",null),e.removeQueries(["user","jobs","customers","parts"])}}},M=function(){var e=_(),t=(e.updateUser,e.clearUser),s=function(){var e=Object(d.a)(l.a.mark((function e(t,s){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.login(t,s);case 3:(c=e.sent).data&&(r={_id:c.data._id,token:c.data.token},localStorage.setItem("metronics",JSON.stringify(r))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0.message);case 10:case"end":return e.stop()}var r}),e,null,[[0,7]])})));return function(t,s){return e.apply(this,arguments)}}(),c=function(){var e=Object(d.a)(l.a.mark((function e(t){var s,c,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.username,c=t.password,r={username:s,password:c},e.prev=2,e.next=5,C.register(r);case 5:return a=e.sent,e.abrupt("return",a);case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}();return{login:s,register:c,logout:function(){h(),t()}}},T=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.getMessages();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0.message),window.location.reload();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),E=function(){return Object(u.useQuery)("messages",(function(){return T()}))},V=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.getRequests();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0.message),window.location.reload();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),Y=function(){return Object(u.useQuery)("requests",(function(){return V()}))},I=new u.QueryClient({defaultOptions:{queries:{staleTime:6e5,cacheTime:9e5,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1}}}),J=function(e){var t=Object(u.useQuery)(e,(function(){})).data;return void 0===t?null:t},A=s(44),B=function(){var e=Object(u.useQueryClient)(),t=Object(c.useState)([]),s=Object(L.a)(t,2),r=s[0],a=s[1];Object(c.useEffect)((function(){if(r.length){var t=setInterval((function(){a(r.slice(1)),e.setQueryData("toasts",r.slice(1))}),5e3);return function(){return clearInterval(t)}}}),[r]),Object(u.useQuery)("toasts",(function(){}),{onSuccess:function(e){a(void 0===e?[]:e)}});return{toasts:r,addToast:function(t){var s={id:r.length,msg:t};a([].concat(Object(A.a)(r),[s])),e.setQueryData("toasts",[].concat(Object(A.a)(r),[s]))},deleteToast:function(t){a(r.filter((function(e){return e.id!==t}))),e.setQueryData("toasts",r.filter((function(e){return e.id!==t})))}}},U=s(22),R=s(14),z=s(12),H=s(13),$=(s(99),s(0)),G=function(){var e=_().user,t=M().login,s=Object(R.g)();if(e)return Object($.jsx)(R.a,{to:"/dashboard"});var c=function(){var e=Object(d.a)(l.a.mark((function e(c){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c.preventDefault(),r=Object.fromEntries(new FormData(c.target)),a={username:r.username,password:r.password},e.next=6,t(a);case 6:s.push("/dashboard"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return Object($.jsx)("main",{children:Object($.jsxs)("div",{id:"card-login",children:[Object($.jsx)("h1",{children:"Metronics"}),Object($.jsxs)("form",{id:"form-login",onSubmit:c,children:[Object($.jsx)(z.a,{className:"icon-faUser",icon:H.j}),Object($.jsxs)("label",{children:["Username",Object($.jsx)("input",{type:"text",name:"username",defaultValue:"test",required:!0})]}),Object($.jsx)(z.a,{className:"icon-faLock",icon:H.f}),Object($.jsxs)("label",{children:["Password",Object($.jsx)("input",{type:"password",name:"password",defaultValue:"password",required:!0})]}),Object($.jsx)("button",{className:"btn-login",type:"submit",children:"LOGIN"})]})]})})},Z=function(){var e=M().register,t=Object(R.g)(),s=function(){var s=Object(d.a)(l.a.mark((function s(c){var r;return l.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,c.preventDefault(),r=Object.fromEntries(new FormData(c.target)),s.next=5,e({username:r.username,password:r.password});case 5:201===s.sent.status&&t.push("/dashboard"),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(0),console.error(s.t0);case 12:case"end":return s.stop()}}),s,null,[[0,9]])})));return function(e){return s.apply(this,arguments)}}();return Object($.jsx)("main",{children:Object($.jsxs)("div",{id:"card-login",children:[Object($.jsx)("h1",{children:"Metronics"}),Object($.jsxs)("form",{id:"form-login",onSubmit:s,children:[Object($.jsx)(z.a,{className:"icon-faUser",icon:H.j}),Object($.jsxs)("label",{children:["Username",Object($.jsx)("input",{type:"text",name:"username",required:!0})]}),Object($.jsx)(z.a,{className:"icon-faLock",icon:H.f}),Object($.jsxs)("label",{children:["Password",Object($.jsx)("input",{type:"password",name:"password",required:!0})]}),Object($.jsx)("button",{className:"btn-login",type:"submit",children:"REGISTER"})]})]})})},W=function(){var e=Object(u.useQueryClient)();return Object($.jsxs)("div",{className:"main-header",children:[Object($.jsx)("h1",{onClick:function(){e.setQueryData("view","default")},children:"Dashboard"}),Object($.jsxs)("div",{className:"button-area",children:[Object($.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","overview")},children:"Overview"}),Object($.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","messages")},children:"View Messages"})]})]})},X=s(24),K=s(16),ee=s(10),te=s.n(ee),se=function(e){var t=e.messages,s=Object(u.useQueryClient)(),r=Object(c.useState)(t),a=Object(L.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(!1),j=Object(L.a)(o,2),b=j[0],m=j[1];Object(c.useEffect)((function(){i(!1===b?t.filter((function(e){return!1===e.read})):t.filter((function(e){return!0===e.read})))}),[b,t]);var h=Object(u.useMutation)((function(e){return C.updateMessage(e.id,e.data)}),{onSuccess:function(){s.invalidateQueries("messages")}}),O=function(){var e=Object(d.a)(l.a.mark((function e(t){var s,c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),s=document.getElementsByClassName("toggle-btn"),c=Object(X.a)(s);try{for(c.s();!(r=c.n()).done;)r.value.classList.remove("active")}catch(a){c.e(a)}finally{c.f()}t.currentTarget.classList.add("active"),"Read"===t.currentTarget.innerHTML?m(!0):m(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object($.jsxs)("section",{className:"section-messages",children:[Object($.jsxs)("div",{className:"read-toggle",children:[Object($.jsx)("div",{className:"toggle-btn left active",onClick:function(e){return O(e)},children:"Unread"}),Object($.jsx)("div",{className:"toggle-btn right",onClick:function(e){return O(e)},children:"Read"})]}),n.map((function(e){return Object($.jsxs)("div",{className:"message",children:[Object($.jsxs)("div",{className:"msg-header",children:[Object($.jsxs)("p",{children:["From: ",Object($.jsx)("strong",{children:e.name})]}),Object($.jsx)("p",{children:e.email}),Object($.jsx)("p",{children:te()(e.createdAt).format("MMM D, YYYY")})]}),Object($.jsx)("p",{children:e.message}),Object($.jsx)("p",{className:"mark-read text-right",onClick:function(){return function(e){var t=!1===e.read;h.mutate({id:e._id,data:Object(K.a)(Object(K.a)({},e),{},{read:t})})}(e)},children:!1===e.read?"Mark as read":"Mark as unread"})]},e._id)})),n.length<1?Object($.jsx)("p",{className:"empty",children:"** No messages to display **"}):Object($.jsx)($.Fragment,{})]})},ce=function(e){var t=e.jobs,s=Object(u.useQueryClient)(),r=Object(c.useState)([]),a=Object(L.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)([]),l=Object(L.a)(o,2),d=l[0],j=l[1],b=te()(new Date);Object(c.useEffect)((function(){i(t.filter((function(e){return"Canceled"!==e.status}))),j((function(){for(var e=[],t=0;t<5;t++)e.push({name:te()(b).add(t,"day").format("dddd"),number:te()(b).add(t,"day").format("DD")});return e}))}),[t]);return Object($.jsxs)("section",{className:"section-calendar",children:[Object($.jsx)("h2",{children:"5 DAY SCHEDULE"}),Object($.jsx)("div",{className:"upcoming",children:d.map((function(e){return Object($.jsxs)("div",{className:"card-day",children:[Object($.jsxs)("h3",{children:[Object($.jsx)("span",{children:e.name}),Object($.jsx)("span",{children:e.number})]}),Object($.jsx)("div",{children:n.filter((function(t){return te()(t.serviceDate).format("dddd")===e.name&&te()(t.serviceDate)>b.subtract(1,"day")&&te()(t.serviceDate)<b.add(5,"day")})).sort((function(e,t){return e.customer.address.city.charCodeAt(0)-t.customer.address.city.charCodeAt(0)})).map((function(e){return Object($.jsxs)("p",{onClick:function(){return function(e){s.setQueryData("submissionType","edit"),s.setQueryData("selectedJob",e),s.setQueryData("selectedCustomer",e.customer),s.setQueryData("view","serviceForm")}(e)},children:[e.customer.businessName,Object($.jsx)("br",{}),Object($.jsx)("span",{children:e.customer.address.city})]},e._id)}))})]},e.number)}))})]})},re=function(e){var t=e.jobs,s=e.requests,c=e.messages,r=e.parts,a=Object(u.useQueryClient)(),n=Object(R.g)();return Object($.jsxs)("section",{className:"section-notifications",children:[Object($.jsx)("h2",{children:"NOTIFICATIONS"}),Object($.jsxs)("div",{children:[t.length?Object($.jsx)("p",{className:"notice",onClick:function(){a.setQueryData("view","all"),n.push("/service")},children:"There are new jobs that need to be scheduled."}):Object($.jsx)($.Fragment,{}),s.length?Object($.jsx)("p",{className:"notice",onClick:function(){a.setQueryData("view","requests"),n.push("/service")},children:"There are new online requests awaiting your review."}):Object($.jsx)($.Fragment,{}),c.length?Object($.jsx)("p",{className:"notice",onClick:function(){a.setQueryData("view","messages")},children:"You have unread messages in your inbox."}):Object($.jsx)($.Fragment,{}),r.length?Object($.jsx)("p",{className:"notice",onClick:function(){a.setQueryData("view","restock"),n.push("/inventory")},children:"Some parts need to be re-ordered."}):Object($.jsx)($.Fragment,{}),r.length||t.length||s.length||c.length?Object($.jsx)($.Fragment,{}):Object($.jsx)("p",{className:"empty-notifications",children:"** You're all caught up. **"})]})]})},ae=function(e){var t=e.jobs,s=Object(u.useQueryClient)(),r=Object(R.g)(),a=Object(c.useState)(0),n=Object(L.a)(a,2),i=n[0],o=n[1],l=Object(c.useState)(0),d=Object(L.a)(l,2),j=d[0],b=d[1],m=te()(new Date).format("YYYY"),h=Intl.NumberFormat("en-US");return Object(c.useEffect)((function(){var e,s=0,c=0,r=Object(X.a)(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;te()(a.serviceDate).format("YYYY")===m&&a.isPaid&&(s+=a.totalBill),te()(a.serviceDate).format("YYYY")<=m&&!a.isPaid&&(c+=a.totalBill)}}catch(n){r.e(n)}finally{r.f()}o(h.format(s)),b(h.format(c))}),[t]),Object($.jsxs)("section",{className:"section-revenue",children:[Object($.jsx)("h2",{children:"YTD SERVICE REVENUE"}),Object($.jsxs)("p",{className:"revenue",children:["$",i]}),Object($.jsxs)("p",{className:"outstanding",onClick:function(){s.setQueryData("view","unpaid"),r.push("/service")},children:["$",j," outstanding"]})]})},ne=function(){var e=Object(u.useQueryClient)(),t=J("view");return Object($.jsxs)("div",{className:"main-header",children:[Object($.jsx)("h1",{onClick:function(){return window.location.reload()},children:"Service Jobs"}),Object($.jsxs)("div",{className:"button-area",children:[Object($.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","default")},children:"View All"}),Object($.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","requests")},children:"View Online Requests"}),Object($.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","unpaid")},children:"View Unpaid"}),Object($.jsx)("p",{className:"btn",onClick:function(){if(e.setQueryData("selectedCustomer",null),e.setQueryData("selectedJob",null),e.setQueryData("submissionType","new"),"serviceForm"===t){var s,c=document.querySelectorAll("input, textarea"),r=Object(X.a)(c);try{for(r.s();!(s=r.n()).done;){s.value.value=""}}catch(a){r.e(a)}finally{r.f()}}else e.setQueryData("view","serviceForm")},children:"Create New"})]})]})},ie=(s(106),function(){var e=Object(u.useQueryClient)(),t=M().logout,s=Object(R.g)(),r=Object(c.useState)(""),a=Object(L.a)(r,2),n=a[0],i=a[1],o=J("view");Object(c.useEffect)((function(){var e=window.location.pathname;i(e)}),[o]),Object(c.useEffect)((function(){var e,t=document.querySelectorAll("svg"),s=Object(X.a)(t);try{for(s.s();!(e=s.n()).done;){e.value.classList.remove("active")}}catch(c){s.e(c)}finally{s.f()}switch(n){case"/dashboard":t[0].classList.add("active");break;case"/customers":t[1].classList.add("active");break;case"/service":t[2].classList.add("active");break;case"/inventory":t[3].classList.add("active")}}),[n]);return Object($.jsx)("header",{children:Object($.jsxs)("nav",{className:"navbar",children:[Object($.jsxs)("ul",{children:[Object($.jsx)("li",{className:"nav-item",onClick:function(){e.setQueryData("view","default"),i("/dashboard"),s.push("/dashboard")},children:Object($.jsx)(z.a,{icon:H.e})}),Object($.jsx)("li",{className:"nav-item",onClick:function(){e.setQueryData("view","default"),i("/customers"),s.push("/customers")},children:Object($.jsx)(z.a,{icon:H.k})}),Object($.jsx)("li",{className:"nav-item",onClick:function(){e.setQueryData("view","default"),i("/service"),s.push("/service")},children:Object($.jsx)(z.a,{icon:H.i})}),Object($.jsx)("li",{className:"nav-item",onClick:function(){e.setQueryData("view","default"),i("/inventory"),s.push("/inventory")},children:Object($.jsx)(z.a,{icon:H.l})})]}),Object($.jsx)("button",{className:"signOut",onClick:function(){t(),s.push("/"),window.location.reload()},children:Object($.jsx)(z.a,{icon:H.h})})]})})}),ue=(s(107),function(e){var t=e.placeholder,s=e.setSearch;return Object($.jsxs)("div",{className:"searchbar",children:[Object($.jsx)(z.a,{className:"faSearch",icon:H.g}),Object($.jsx)("input",{className:"search",name:"search",onChange:function(e){e.preventDefault(),s(e.currentTarget.value)},type:"text",placeholder:t})]})}),oe=(s(108),function(){var e,t=Object(u.useQueryClient)(),s=Q().data,r=Object(c.useState)(0),a=Object(L.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)([]),l=Object(L.a)(o,2),d=l[0],j=l[1],b=Object(c.useState)(!1),m=Object(L.a)(b,2),h=m[0],O=m[1],x=Object(c.useState)(""),f=Object(L.a)(x,2),p=f[0],v=f[1],y=function(e){var c=s.data.filter((function(t){return t._id===e.target.dataset.id}));t.setQueryData("submissionType","add"),t.setQueryData("selectedCustomer",c[0]),v(c[0].businessName),i(0),j([]),O(!1)};return h&&p&&d.length&&(e=Object($.jsx)("ul",{className:"suggestions",children:d.map((function(e,t){var s;return t===n&&(s="suggestion-active"),Object($.jsxs)("li",{className:s,"data-id":e._id,onClick:y,children:[e.businessName," - ",e.address.street1,", ",e.address.city]},e._id)}))})),Object($.jsxs)($.Fragment,{children:[Object($.jsx)("input",{type:"text",placeholder:"Business Name",name:"businessName",onChange:function(e){var t=s.data,c=e.target.value,r=t.filter((function(e){return e.businessName.toLowerCase().indexOf(c.toLowerCase())>-1}));i(0),j(r),O(!0),v(e.target.value)},value:p,required:!0}),d.length?e:""]})}),le=(s(109),function(){var e=B(),t=e.toasts,s=e.deleteToast;return Object($.jsx)("footer",{className:"toast-container",children:t.map((function(e){return Object($.jsxs)("div",{className:"toast-card",children:[Object($.jsx)("button",{onClick:function(){return s(e.id)},children:"X"}),Object($.jsx)("p",{className:"toast-message",children:e.msg})]},e.id)}))})}),de=function(e){for(var t=0;t<e.length;t++)"Pending"===e[t].status&&e.unshift(e.splice(t,1)[0]);return e},je=function(e){var t=e.jobs,s=Object(u.useQueryClient)(),r=Object(c.useState)([]),a=Object(L.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(""),l=Object(L.a)(o,2),d=l[0],j=l[1],b=Object(c.useState)(""),m=Object(L.a)(b,2),h=m[0],O=m[1];return Object(c.useEffect)((function(){var e=de(t);i("Pending"===d?e.filter((function(e){return"Pending"===e.status})):"Scheduled"===d?e.filter((function(e){return"Scheduled"===e.status})):"Completed"===d?e.filter((function(e){return"Completed"===e.status})):"Canceled"===d?e.filter((function(e){return"Canceled"===e.status})):e)}),[d,t]),Object(c.useEffect)((function(){var e=de(t);i(""!==h?e.filter((function(e){return e.customer.businessName.toLowerCase().includes(h.toLowerCase())||e.customer.address.city.toLowerCase().includes(h.toLowerCase())||null!==e.serviceDate&&e.serviceDate.includes(h)||null!==e.invoiceNumber&&e.invoiceNumber.includes(h)})):e)}),[h,t]),Object($.jsxs)("section",{children:[Object($.jsxs)("div",{className:"section-header",children:[Object($.jsx)("div",{children:Object($.jsx)(ue,{placeholder:"Search",setSearch:O})}),Object($.jsxs)("div",{className:"dropdown",children:[Object($.jsx)(z.a,{className:"faChevronDown",icon:H.a}),Object($.jsxs)("select",{onChange:function(e){return j(e.target.value)},children:[Object($.jsx)("option",{children:"Filter by status"}),Object($.jsx)("option",{children:"Pending"}),Object($.jsx)("option",{children:"Scheduled"}),Object($.jsx)("option",{children:"Completed"}),Object($.jsx)("option",{children:"Canceled"})]})]})]}),Object($.jsxs)("table",{children:[Object($.jsx)("thead",{children:Object($.jsxs)("tr",{className:"tr-job",children:[Object($.jsx)("th",{className:"text-center",children:"Service Date"}),Object($.jsx)("th",{children:"Business Name"}),Object($.jsx)("th",{children:"City"}),Object($.jsx)("th",{className:"text-center",children:"Invoice #"}),Object($.jsx)("th",{className:"text-center",children:"Status"})]})}),Object($.jsx)("tbody",{children:n.map((function(e){return Object($.jsxs)("tr",{className:"table-item tr-job clickable",onClick:function(){s.setQueryData("submissionType","edit"),s.setQueryData("selectedJob",e),s.setQueryData("selectedCustomer",e.customer),s.setQueryData("view","serviceForm")},children:[Object($.jsx)("td",{className:"text-center",children:e.serviceDate?te()(e.serviceDate).format("MMM D, YYYY"):"--"}),Object($.jsx)("td",{children:e.customer.businessName}),Object($.jsx)("td",{children:e.customer.address.city}),Object($.jsx)("td",{className:"text-center",children:e.invoiceNumber?e.invoiceNumber:"--"}),Object($.jsx)("td",{className:"text-center",children:e.status})]},e._id)}))})]}),n.length<1?Object($.jsx)("p",{className:"empty",children:"** No jobs to display **"}):Object($.jsx)($.Fragment,{})]})},be=function(e){var t=e.requests,s=Object(u.useQueryClient)(),r=Object(c.useState)([]),a=Object(L.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(""),l=Object(L.a)(o,2),d=l[0],j=l[1];return Object(c.useEffect)((function(){i(t.filter((function(e){return e.customer.businessName.toLowerCase().includes(d.toLowerCase())||e.customer.address.city.toLowerCase().includes(d.toLowerCase())||e.customer.contactName.toLowerCase().includes(d.toLowerCase())||e.customer.phone.includes(d)})))}),[d,t]),Object($.jsxs)("section",{children:[Object($.jsx)("div",{className:"section-header",children:Object($.jsx)("div",{children:Object($.jsx)(ue,{placeholder:"Search",setSearch:j})})}),Object($.jsxs)("table",{children:[Object($.jsx)("thead",{children:Object($.jsxs)("tr",{className:"tr-job",children:[Object($.jsx)("th",{className:"text-center",children:"Date Submitted"}),Object($.jsx)("th",{children:"Business Name"}),Object($.jsx)("th",{children:"City"}),Object($.jsx)("th",{className:"text-center",children:"Contact Name"}),Object($.jsx)("th",{className:"text-center",children:"Phone #"})]})}),Object($.jsx)("tbody",{children:n.map((function(e){return Object($.jsxs)("tr",{className:"table-item tr-job clickable",onClick:function(){s.setQueryData("submissionType","new"),s.setQueryData("selectedJob",{_id:e._id,status:"Pending",issueNotes:e.issueNotes}),s.setQueryData("selectedCustomer",e.customer),s.setQueryData("view","serviceForm"),s.setQueryData("deleteRequest",!0)},children:[Object($.jsx)("td",{className:"text-center",children:te()(e.createdAt).format("MMM D, YYYY")}),Object($.jsx)("td",{children:e.customer.businessName}),Object($.jsxs)("td",{children:[e.customer.address.city,", ",e.customer.address.state]}),Object($.jsx)("td",{className:"text-center",children:e.customer.contactName}),Object($.jsx)("td",{className:"text-center",children:e.customer.phone})]},e._id)}))})]}),n.length<1?Object($.jsx)("p",{className:"empty",children:"** No online requests to display **"}):Object($.jsx)($.Fragment,{})]})},me=function(e){var t=e.jobs,s=Object(u.useQueryClient)(),r=Object(c.useState)([]),a=Object(L.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(""),l=Object(L.a)(o,2),d=l[0],j=l[1],b=Intl.NumberFormat("en-US");Object(c.useEffect)((function(){i(""===d?t.filter((function(e){return!e.isPaid&&"Completed"===e.status})):n.filter((function(e){return e.customer.businessName.toLowerCase().includes(d.toLowerCase())||e.customer.address.city.toLowerCase().includes(d.toLowerCase())||e.customer.contactName.toLowerCase().includes(d.toLowerCase())||e.customer.phone.includes(d)})))}),[d,t]);var m=Object(u.useMutation)((function(e){return C.updateJob(e.id,e.data)}),{onSuccess:function(){s.invalidateQueries("jobs")}});return Object($.jsxs)("section",{children:[Object($.jsx)("div",{className:"section-header",children:Object($.jsx)("div",{children:Object($.jsx)(ue,{placeholder:"Search",setSearch:j})})}),Object($.jsxs)("table",{children:[Object($.jsx)("thead",{children:Object($.jsxs)("tr",{className:"tr-job",children:[Object($.jsx)("th",{className:"text-center",children:"Service Date"}),Object($.jsx)("th",{children:"Business Name"}),Object($.jsx)("th",{className:"text-center",children:"Invoice #"}),Object($.jsx)("th",{className:"text-center",children:"Total Bill"}),Object($.jsx)("th",{})]})}),Object($.jsx)("tbody",{children:n.map((function(e){return Object($.jsxs)("tr",{className:"table-item tr-job",children:[Object($.jsx)("td",{className:"text-center",children:e.serviceDate?te()(e.serviceDate).format("MMM D, YYYY"):"--"}),Object($.jsx)("td",{children:e.customer.businessName}),Object($.jsx)("td",{className:"text-center",children:e.invoiceNumber?e.invoiceNumber:"--"}),Object($.jsxs)("td",{className:"text-center",children:["$ ",b.format(e.totalBill)]}),Object($.jsx)("td",{className:"mark-paid text-center",onClick:function(){return function(e){m.mutate({id:e._id,data:Object(K.a)(Object(K.a)({},e),{},{isPaid:!0})})}(e)},children:"Mark as paid"})]},e._id)}))})]}),n.length<1?Object($.jsx)("p",{className:"empty",children:"** No unpaid jobs to display **"}):Object($.jsx)($.Fragment,{})]})},he=function(){var e=Object(u.useQueryClient)(),t=Q(),s=t.status,r=t.data,a=t.error,n=B().addToast,i=J("existingCustomer"),o=J("deleteRequest"),j=J("submissionType"),b=J("selectedCustomer"),m=J("selectedJob"),h=J("view"),O=Intl.NumberFormat("en-US");Object(c.useEffect)((function(){if("success"===s&&"requests"===h){var t=r.data.filter((function(e){return b.address.street1.toLowerCase()===e.address.street1.toLowerCase()&&b.address.city.toLowerCase()===e.address.city.toLowerCase()}));t.length>0&&e.setQueryData("existingCustomer",t[0])}}),[]);var x=Object(u.useMutation)((function(e){return C.createJob(e)}),{onSuccess:function(){e.invalidateQueries("jobs")}}),f=Object(u.useMutation)((function(e){return C.updateJob(e.id,e.data)}),{onSuccess:function(){e.invalidateQueries("jobs")}}),p=Object(u.useMutation)((function(e){return C.deleteJob(e)}),{onSuccess:function(){e.invalidateQueries("jobs")}}),v=Object(u.useMutation)((function(e){return C.createCustomer(e)}),{onSuccess:function(){e.invalidateQueries("customers")}}),y=Object(u.useMutation)((function(e){return C.updateCustomer(e.id,e.data)}),{onSuccess:function(){e.invalidateQueries("customers")}}),N=Object(u.useMutation)((function(e){return C.deleteRequest(e)}),{onSuccess:function(){e.invalidateQueries("requests")}}),g=function(e){N.mutate(e)},w=function(){var t=Object(d.a)(l.a.mark((function t(s){var c,r,a,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s.preventDefault(),t.prev=1,c=Object.fromEntries(new FormData(s.target)),r={status:c.status,serviceDate:c.serviceDate,invoiceNumber:c.invoiceNumber.trim(),issueNotes:c.issueNotes.trim(),serviceNotes:c.serviceNotes.trim(),totalBill:parseFloat(c.totalBill.trim()),isPaid:"on"===c.isPaid},a={businessName:c.businessName.trim(),contactName:c.contactName.trim(),phone:c.phone.trim(),address:{street1:c.street1.trim(),street2:c.street2.trim(),city:c.city.trim(),state:c.state.trim(),zipcode:c.zipcode.trim()}},"add"!==j){t.next=15;break}if(y.mutate({id:b._id,data:a}),x.mutate(Object(K.a)({customer:b._id},r)),!o){t.next=13;break}return g(m._id),e.setQueryData("deleteRequest",null),e.setQueryData("view","requests"),t.abrupt("return");case 13:return e.setQueryData("view","default"),t.abrupt("return");case 15:if("edit"!==j){t.next=20;break}return y.mutate({id:b._id,data:a}),f.mutate({id:m._id,data:r}),e.setQueryData("view","default"),t.abrupt("return");case 20:if("new"!==j){t.next=31;break}return t.next=23,v.mutateAsync(a);case 23:if(n=t.sent,x.mutate(Object(K.a)({customer:n.data._id},r)),!o){t.next=30;break}return g(m._id),e.setQueryData("deleteRequest",null),e.setQueryData("view","requests"),t.abrupt("return");case 30:e.setQueryData("view","default");case 31:t.next=36;break;case 33:t.prev=33,t.t0=t.catch(1),console.error(t.t0);case 36:case"end":return t.stop()}}),t,null,[[1,33]])})));return function(e){return t.apply(this,arguments)}}();switch(s){case"loading":return Object($.jsx)("h1",{children:"Loading"});case"error":return Object($.jsxs)("h4",{children:["Error: ",a.message]});default:return i?Object($.jsx)("section",{children:Object($.jsxs)("div",{className:"use-existing-customer",children:[Object($.jsx)("h4",{children:"The address matches an existing customer:"}),Object($.jsxs)("p",{className:"match",children:[Object($.jsx)("strong",{children:i.businessName}),Object($.jsx)("br",{}),i.address.street1," ",i.address.street2?", "+i.address.street2:Object($.jsx)($.Fragment,{}),Object($.jsx)("br",{}),i.address.city,", ",i.address.state," ",i.address.zipcode]}),Object($.jsxs)("div",{children:[Object($.jsxs)("p",{children:["Add this job to ",Object($.jsx)("strong",{children:i.businessName}),"?"]}),Object($.jsx)("button",{onClick:function(){e.setQueryData("submissionType","add"),e.setQueryData("selectedCustomer",Object(K.a)(Object(K.a)({},b),{},{_id:i._id,businessName:i.businessName,address:i.address})),e.setQueryData("existingCustomer",null)},children:"Yes"}),Object($.jsx)("button",{onClick:function(){return e.setQueryData("existingCustomer",null)},children:"No"})]})]})}):Object($.jsx)("section",{children:Object($.jsxs)("form",{id:"form-service",onSubmit:w,children:[Object($.jsxs)("div",{className:"job-area",children:[Object($.jsxs)("label",{children:["Service Date",Object($.jsx)("input",{className:"input-sm",type:"date",name:"serviceDate",defaultValue:m?m.serviceDate:""})]}),Object($.jsxs)("label",{children:["Status",Object($.jsxs)("div",{className:"dropdown",children:[Object($.jsx)(z.a,{className:"faChevronDown",icon:H.a}),Object($.jsxs)("select",{name:"status",children:[m?Object($.jsx)("option",{children:m.status}):Object($.jsx)($.Fragment,{}),m&&"Pending"===m.status?"":Object($.jsx)("option",{children:"Pending"}),m&&"Scheduled"===m.status?"":Object($.jsx)("option",{children:"Scheduled"}),m&&"Completed"===m.status?"":Object($.jsx)("option",{children:"Completed"}),m&&"Canceled"===m.status?"":Object($.jsx)("option",{children:"Canceled"})]})]})]}),Object($.jsxs)("label",{children:["Invoice",Object($.jsxs)("div",{className:"invoiceInput",children:[Object($.jsx)(z.a,{className:"faHashtag",icon:H.d}),Object($.jsx)("input",{type:"text",name:"invoiceNumber",defaultValue:m?m.invoiceNumber:""})]})]}),Object($.jsxs)("label",{children:["Total Bill",Object($.jsxs)("div",{className:"dollarInput",children:[Object($.jsx)(z.a,{className:"faDollarSign",icon:H.b}),Object($.jsx)("input",{type:"text",name:"totalBill",defaultValue:m?O.format(m.totalBill):"0"})]})]}),Object($.jsxs)("label",{className:"text-center",children:["Paid?",Object($.jsx)("input",{className:"checkbox",type:"checkbox",name:"isPaid",defaultChecked:m&&!0===m.isPaid?"on":void 0})]})]}),Object($.jsxs)("div",{className:"customer-area",children:[Object($.jsx)("div",{children:Object($.jsxs)("label",{children:["Contact Information","requests"!==h&&i?Object($.jsx)(oe,{}):Object($.jsx)("input",{type:"text",name:"businessName",placeholder:"Business Name",required:!0,defaultValue:b?b.businessName:""}),Object($.jsx)("input",{type:"text",name:"contactName",placeholder:"Contact Person",defaultValue:b?b.contactName:""}),Object($.jsx)("input",{type:"text",name:"phone",placeholder:"Phone #",required:!0,defaultValue:b?b.phone:""})]})}),Object($.jsx)("div",{children:Object($.jsxs)("label",{className:"address",children:["Address",Object($.jsx)("input",{type:"text",name:"street1",placeholder:"Street Address",required:!0,defaultValue:b?b.address.street1:""}),Object($.jsx)("input",{type:"text",name:"street2",placeholder:"Unit or Building #",defaultValue:b?b.address.street2:""}),Object($.jsxs)("div",{children:[Object($.jsx)("input",{type:"text",name:"city",placeholder:"City",required:!0,defaultValue:b?b.address.city:""}),Object($.jsx)("input",{className:"text-center",type:"text",name:"state",defaultValue:"CA",required:!0}),Object($.jsx)("input",{type:"text",name:"zipcode",placeholder:"Zip Code",required:!0,defaultValue:b?b.address.zipcode:""})]})]})})]}),Object($.jsxs)("div",{className:"notes-area",children:[Object($.jsxs)("label",{children:["Description of Problem",Object($.jsx)("textarea",{name:"issueNotes",defaultValue:m?m.issueNotes:""})]}),Object($.jsxs)("label",{children:["Service Notes",Object($.jsx)("textarea",{name:"serviceNotes",defaultValue:m?m.serviceNotes:""})]})]}),Object($.jsxs)("div",{className:"button-area",children:[Object($.jsx)("button",{className:"btn-form",type:"submit",children:"Save"}),Object($.jsx)("button",{className:"btn-form",onClick:function(){"/customers"===window.location.pathname?(e.setQueryData("selectedJob",null),e.setQueryData("view","customerForm")):(e.setQueryData("selectedCustomer",null),e.setQueryData("selectedJob",null),e.setQueryData("view","default"))},children:"Cancel"}),m&&m._id?Object($.jsx)("button",{className:"btn-form delete",onClick:function(){var t;"requests"===h?g(m._id):(t=m._id,window.confirm("Are you sure you want to delete?\nThis cannot be undone.")&&p.mutate(t),n("Job Deleted")),e.setQueryData("selectedCustomer",null),e.setQueryData("selectedJob",null),e.setQueryData("view","default")},children:"Delete"}):Object($.jsx)($.Fragment,{})]})]})})}},Oe=(s(110),function(){var e=_().user,t=E(),s=t.status,c=t.data,r=t.error,a=Y(),n=a.status,i=a.data,u=a.error,o=S(),l=o.status,d=o.data,j=o.error,b=q(),m=b.status,h=b.data,O=b.error,x=J("view");if(!e)return Object($.jsx)(R.a,{to:"/"});switch(l||s||n||m){case"loading":return Object($.jsx)("h1",{className:"text-center",children:"Loading"});case"error":return Object($.jsxs)("h4",{className:"text-center",children:["Error: ",j.message," | ",r.message," | ",u.message," | ",O.message]});default:return"messages"===x?Object($.jsxs)("main",{className:"container",id:"dashboard",children:[Object($.jsx)(W,{}),Object($.jsx)(se,{messages:c.data})]}):"serviceForm"===x?Object($.jsxs)("main",{className:"container",id:"dashboard",children:[Object($.jsx)(W,{}),Object($.jsx)(he,{})]}):Object($.jsxs)("main",{className:"container",id:"dashboard",children:[Object($.jsx)(W,{}),Object($.jsxs)("div",{className:"dashboard-top",children:[Object($.jsx)(re,{jobs:"success"===l?d.data.filter((function(e){return"Pending"===e.status})):[],requests:"success"===n?i.data:[],messages:"success"===s?c.data.filter((function(e){return!e.read})):[],parts:"success"===m?h.data.filter((function(e){return e.stock<e.minimum})):[]}),Object($.jsx)(ae,{jobs:d.data.filter((function(e){return"Completed"===e.status}))})]}),Object($.jsx)(ce,{jobs:d.data})]})}}),xe=function(){var e=_().user,t=S(),s=t.status,c=t.data,r=t.error,a=Y(),n=a.status,i=a.data,u=a.error,o=J("view");if(!e)return Object($.jsx)(R.a,{to:"/"});switch(s||n){case"loading":return Object($.jsx)("h1",{className:"text-center",children:"Loading"});case"error":return Object($.jsxs)("h4",{className:"text-center",children:["Error: ",r.message," ",u.message]});default:return"serviceForm"===o?Object($.jsxs)("main",{className:"container",children:[Object($.jsx)(ne,{}),Object($.jsx)(he,{})]}):"requests"===o?Object($.jsxs)("main",{className:"container",children:[Object($.jsx)(ne,{}),Object($.jsx)(be,{requests:i.data})]}):"unpaid"===o?Object($.jsxs)("main",{className:"container",children:[Object($.jsx)(ne,{}),Object($.jsx)(me,{jobs:c.data})]}):Object($.jsxs)("main",{className:"container",children:[Object($.jsx)(ne,{}),Object($.jsx)(je,{jobs:c.data})]})}},fe=function(){var e=Object(u.useQueryClient)(),t=J("view");return Object($.jsxs)("div",{className:"main-header",children:[Object($.jsx)("h1",{onClick:function(){e.setQueryData("view","default")},children:"Customers"}),Object($.jsxs)("div",{className:"button-area",children:[Object($.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","default")},children:"View All"}),Object($.jsx)("p",{className:"btn",onClick:function(){if(e.setQueryData("submissionType","new"),e.setQueryData("selectedCustomer",null),"customerForm"===t){var s,c=document.querySelectorAll("input, textarea"),r=Object(X.a)(c);try{for(r.s();!(s=r.n()).done;){s.value.value=""}}catch(a){r.e(a)}finally{r.f()}}else e.setQueryData("view","customerForm")},children:"Create New"})]})]})},pe=function(e){var t=e.customers,s=Object(u.useQueryClient)(),r=Object(c.useState)([]),a=Object(L.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(""),l=Object(L.a)(o,2),d=l[0],j=l[1];return Object(c.useEffect)((function(){i(""!==d?t.filter((function(e){return e.businessName.toLowerCase().includes(d.toLowerCase())||e.address.city.toLowerCase().includes(d.toLowerCase())||e.phone.includes(d)})):t)}),[d,t]),Object($.jsxs)("section",{children:[Object($.jsx)("div",{className:"section-header",children:Object($.jsx)("div",{children:Object($.jsx)(ue,{placeholder:"Search",setSearch:j})})}),Object($.jsxs)("table",{children:[Object($.jsx)("thead",{children:Object($.jsxs)("tr",{className:"tr-customer",children:[Object($.jsx)("th",{children:"Business Name"}),Object($.jsx)("th",{children:"Address"}),Object($.jsx)("th",{className:"text-center",children:"Contact"}),Object($.jsx)("th",{className:"text-center",children:"Phone #"})]})}),Object($.jsx)("tbody",{children:n.map((function(e){return Object($.jsxs)("tr",{className:"table-item tr-customer clickable",onClick:function(){s.setQueryData("submissionType","edit"),s.setQueryData("selectedCustomer",e),s.setQueryData("view","customerForm")},children:[Object($.jsx)("td",{children:e.businessName}),Object($.jsxs)("td",{children:[e.address.street1,""!==e.address.street2?", "+e.address.street2+", ":", ",e.address.city,", ",e.address.state," ",e.address.zipcode]}),Object($.jsx)("td",{className:"text-center",children:e.contactName?e.contactName:"--"}),Object($.jsx)("td",{className:"text-center",children:e.phone})]},e._id)}))})]}),n.length<1?Object($.jsx)("p",{className:"empty",children:"** No customers to display **"}):Object($.jsx)($.Fragment,{})]})},ve=function(){var e=Object(u.useQueryClient)(),t=B().addToast,s=J("selectedCustomer"),c=J("submissionType"),r=Object(u.useMutation)((function(e){return C.createCustomer(e)}),{onSuccess:function(){e.invalidateQueries("customers")}}),a=Object(u.useMutation)((function(e){return C.updateCustomer(e.id,e.data)}),{onSuccess:function(){e.invalidateQueries("customers"),e.invalidateQueries("jobs")}}),n=Object(u.useMutation)((function(e){return C.deleteCustomer(e)}),{onSuccess:function(){e.invalidateQueries("customers")}}),i=Object(u.useMutation)((function(e){return C.deleteJobsByCustomerId(e)}),{onSuccess:function(){e.invalidateQueries("jobs")}}),o=function(){var c=Object(d.a)(l.a.mark((function c(){return l.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!window.confirm("Are you sure you want to delete?\nThis will delete the customer and their service history from the database.\nThis cannot be undone.")){c.next=7;break}return c.next=4,n.mutate(s._id);case 4:i.mutate(s._id),e.setQueryData("selectedCustomer",null),e.setQueryData("view","default");case 7:t("Customer Deleted");case 8:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}(),j=function(){var t=Object(d.a)(l.a.mark((function t(n){var i,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.preventDefault(),i=Object.fromEntries(new FormData(n.target)),u={businessName:i.businessName.trim(),contactName:i.contactName.trim(),phone:i.phone.trim(),address:{street1:i.street1.trim(),street2:i.street2.trim(),city:i.city.trim(),state:i.state.trim(),zipcode:i.zipcode.trim()},notes:i.notes.trim()},"edit"!==c){t.next=8;break}return a.mutate({id:s._id,data:u}),e.setQueryData("view","default"),t.abrupt("return");case 8:if("new"!==c){t.next=12;break}return t.next=11,r.mutateAsync(u);case 11:e.setQueryData("view","default");case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.error(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}();return Object($.jsx)("section",{children:Object($.jsxs)("form",{id:"form-customer",onSubmit:j,children:[Object($.jsxs)("div",{className:"customer-area",children:[Object($.jsx)("div",{children:Object($.jsxs)("label",{children:["Contact Information",Object($.jsx)("input",{type:"text",name:"businessName",placeholder:"Business Name",required:!0,defaultValue:s?s.businessName:""}),Object($.jsx)("input",{type:"text",name:"contactName",placeholder:"Contact Person",defaultValue:s?s.contactName:""}),Object($.jsx)("input",{type:"text",name:"phone",placeholder:"Phone #",required:!0,defaultValue:s?s.phone:""})]})}),Object($.jsx)("div",{children:Object($.jsxs)("label",{className:"address",children:["Address",Object($.jsx)("input",{type:"text",name:"street1",placeholder:"Street Address",required:!0,defaultValue:s?s.address.street1:""}),Object($.jsx)("input",{type:"text",name:"street2",placeholder:"Unit or Building #",defaultValue:s?s.address.street2:""}),Object($.jsxs)("div",{children:[Object($.jsx)("input",{type:"text",name:"city",placeholder:"City",required:!0,defaultValue:s?s.address.city:""}),Object($.jsx)("input",{className:"text-center",type:"text",name:"state",defaultValue:"CA",required:!0}),Object($.jsx)("input",{type:"text",name:"zipcode",placeholder:"Zip Code",required:!0,defaultValue:s?s.address.zipcode:""})]})]})})]}),Object($.jsx)("div",{className:"notes-area",children:Object($.jsxs)("label",{children:["Notes",Object($.jsx)("textarea",{name:"notes",defaultValue:s?s.notes:""})]})}),Object($.jsxs)("div",{className:"button-area",children:[Object($.jsx)("button",{className:"btn-form",type:"submit",children:"Save"}),Object($.jsx)("button",{className:"btn-form",onClick:function(){e.setQueryData("selectedCustomer",null),e.setQueryData("view","default")},children:"Cancel"}),s&&s._id?Object($.jsx)("button",{className:"btn-form delete",onClick:o,children:"Delete"}):Object($.jsx)($.Fragment,{})]})]})})},ye=function(e){var t=e.jobs,s=e.customerId,r=Object(u.useQueryClient)(),a=Object(c.useState)([]),n=Object(L.a)(a,2),i=n[0],o=n[1];return Object(c.useEffect)((function(){var e=t.filter((function(e){return e.customer._id===s&&"Completed"===e.status}));o(e)}),[s,t]),Object($.jsxs)("section",{className:"customer-history",children:[Object($.jsx)("h2",{children:"Service History"}),Object($.jsxs)("table",{children:[Object($.jsx)("thead",{children:Object($.jsxs)("tr",{className:"tr-history",children:[Object($.jsx)("th",{className:"text-center",children:"Date Completed"}),Object($.jsx)("th",{children:"Service Notes"})]})}),Object($.jsx)("tbody",{className:"tbody-history",children:i.map((function(e){return Object($.jsxs)("tr",{className:"table-item clickable tr-history",onClick:function(){r.setQueryData("submissionType","edit"),r.setQueryData("selectedJob",e),r.setQueryData("view","serviceForm")},children:[Object($.jsx)("td",{className:"text-center",children:e.serviceDate?te()(e.serviceDate).format("MMM DD YYYY"):"--"}),Object($.jsx)("td",{children:e.serviceNotes?e.serviceNotes:""})]},e._id)}))})]}),i.length<1?Object($.jsx)("p",{className:"empty",children:"** No job history to display **"}):Object($.jsx)($.Fragment,{})]})},Ne=function(){var e=_().user,t=Q(),s=t.status,c=t.data,r=t.error,a=S(),n=a.status,i=a.data,u=a.error,o=J("selectedCustomer"),l=J("view");if(!e)return Object($.jsx)(R.a,{to:"/"});switch(s||n){case"loading":return Object($.jsx)("h1",{className:"text-center",children:"Loading"});case"error":return Object($.jsxs)("h4",{className:"text-center",children:["Error: ",r.message," ",u.message]});default:return"customerForm"===l?Object($.jsxs)("main",{className:"container",children:[Object($.jsx)(fe,{}),Object($.jsx)(ve,{}),o?Object($.jsx)(ye,{jobs:i.data,customerId:o._id}):Object($.jsx)($.Fragment,{})]}):"serviceForm"===l?Object($.jsxs)("main",{className:"container",children:[Object($.jsx)(fe,{}),Object($.jsx)(he,{})]}):Object($.jsxs)("main",{className:"container",children:[Object($.jsx)(fe,{}),Object($.jsx)(pe,{customers:c.data})]})}},ge=function(){var e=Object(u.useQueryClient)();return Object($.jsxs)("div",{className:"main-header",children:[Object($.jsx)("h1",{onClick:function(){e.setQueryData("view","default")},children:"Inventory"}),Object($.jsxs)("div",{className:"button-area",children:[Object($.jsx)("p",{className:"btn",onClick:function(){e.refetchQueries("parts"),e.setQueryData("view","default")},children:"View All"}),Object($.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","restock")},children:"View Low Stock"}),Object($.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("submissionType","new"),e.setQueryData("view","newPart")},children:"Create New"})]})]})},we=function(e){var t=e.parts,s=Object(u.useQueryClient)(),r=Object(c.useState)([]),a=Object(L.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(""),l=Object(L.a)(o,2),d=l[0],j=l[1];Object(c.useEffect)((function(){i(""!==d?t.filter((function(e){return e.partNumber.toLowerCase().includes(d.toLowerCase())||e.description.toLowerCase().includes(d.toLowerCase())})):t)}),[d,t]);var b=Object(u.useMutation)((function(e){return C.updatePart(e.id,e.data)}),{onSuccess:function(){s.invalidateQueries("parts")}}),m=function(e,t){"+"===e.target.innerHTML?b.mutate({id:t._id,data:Object(K.a)(Object(K.a)({},t),{},{stock:t.stock+1})}):b.mutate({id:t._id,data:Object(K.a)(Object(K.a)({},t),{},{stock:t.stock-1})})};return Object($.jsxs)("section",{children:[Object($.jsx)("div",{className:"section-header",children:Object($.jsx)("div",{children:Object($.jsx)(ue,{placeholder:"Search",setSearch:j})})}),Object($.jsxs)("table",{children:[Object($.jsx)("thead",{children:Object($.jsxs)("tr",{className:"tr-part",children:[Object($.jsx)("th",{children:"Part #"}),Object($.jsx)("th",{children:"Description"}),Object($.jsx)("th",{className:"text-center",children:"In Stock"}),Object($.jsx)("th",{className:"text-center",children:"Change Quantity"}),Object($.jsx)("th",{className:"text-center",children:"Edit"})]})}),Object($.jsx)("tbody",{children:n.map((function(e){return Object($.jsxs)("tr",{className:"table-item tr-part",id:e._id,children:[Object($.jsx)("td",{children:e.partNumber}),Object($.jsx)("td",{children:e.description}),Object($.jsx)("td",{className:"text-center ".concat(e.stock<e.minimum?"red bold":""),children:e.stock}),Object($.jsxs)("td",{className:"inventory-buttons",children:[Object($.jsx)("div",{className:"quantity",onClick:function(t){return m(t,e)},children:"+"}),Object($.jsx)("div",{className:"quantity",onClick:function(t){return m(t,e)},children:"\u2212"})]}),Object($.jsx)("td",{className:"inventory-buttons",children:Object($.jsx)("div",{className:"select",onClick:function(){s.setQueryData("submissionType","edit"),s.setQueryData("selectedPart",e),s.setQueryData("view","newPart")},children:Object($.jsx)(z.a,{icon:H.c})})})]},e._id)}))})]}),n.length<1?Object($.jsx)("p",{className:"empty",children:"** No parts to display **"}):Object($.jsx)($.Fragment,{})]})},Ce=function(e){var t=e.parts,s=Object(c.useState)(t),r=Object(L.a)(s,2),a=r[0],n=r[1];return Object(c.useEffect)((function(){n(t.filter((function(e){return e.stock<e.minimum})))}),[t]),Object($.jsxs)("section",{children:[Object($.jsxs)("table",{children:[Object($.jsx)("thead",{children:Object($.jsxs)("tr",{className:"tr-restock",children:[Object($.jsx)("th",{children:"Part #"}),Object($.jsx)("th",{children:"Description"}),Object($.jsx)("th",{className:"text-center",children:"In Stock"}),Object($.jsx)("th",{})]})}),Object($.jsx)("tbody",{children:a.map((function(e){return Object($.jsxs)("tr",{className:"table-item tr-restock",id:e._id,children:[Object($.jsx)("td",{children:e.partNumber}),Object($.jsx)("td",{children:e.description}),Object($.jsx)("td",{className:"text-center",children:e.stock}),Object($.jsx)("td",{className:"inventory-buttons",children:Object($.jsxs)("p",{className:"warning",children:["desired minimum: ",e.minimum]})})]},e._id)}))})]}),a.length<1?Object($.jsx)("p",{className:"empty",children:"** No parts to display **"}):Object($.jsx)($.Fragment,{})]})},De=function(){var e=Object(u.useQueryClient)(),t=B().addToast,s=J("selectedPart"),c=J("submissionType"),r=Object(u.useMutation)((function(e){return C.createPart(e)}),{onSuccess:function(){e.invalidateQueries("parts")}}),a=Object(u.useMutation)((function(e){return C.updatePart(e.id,e.data)}),{onSuccess:function(){e.invalidateQueries("parts")}}),n=Object(u.useMutation)((function(e){return C.deletePart(e)}),{onSuccess:function(){e.invalidateQueries("parts")}}),i=function(){var t=Object(d.a)(l.a.mark((function t(n){var i,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.preventDefault(),i=Object.fromEntries(new FormData(n.target)),u={partNumber:i.partNumber.toUpperCase().trim(),description:i.description.trim(),stock:parseInt(i.stock),minimum:parseInt(i.minimum)},"edit"!==c){t.next=9;break}return t.next=7,a.mutate({id:s._id,data:u});case 7:return e.setQueryData("showPartForm",!1),t.abrupt("return");case 9:if("new"!==c){t.next=13;break}return t.next=12,r.mutate(u);case 12:e.setQueryData("showPartForm",!1);case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),console.error(t.t0);case 18:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}();return Object($.jsx)("section",{children:Object($.jsxs)("form",{id:"form-part",onSubmit:i,children:[Object($.jsxs)("div",{children:[Object($.jsxs)("label",{className:"text-center",children:["Part #",Object($.jsx)("input",{className:"text-center",type:"text",name:"partNumber",placeholder:"Part #",defaultValue:s?s.partNumber:""})]}),Object($.jsxs)("label",{children:["Description",Object($.jsx)("input",{type:"text",name:"description",placeholder:"Description",defaultValue:s?s.description:""})]}),Object($.jsxs)("label",{className:"text-center",children:["In Stock",Object($.jsx)("input",{className:"text-center",type:"text",name:"stock",placeholder:"#",defaultValue:s?s.stock:""})]})]}),Object($.jsx)("div",{children:Object($.jsxs)("label",{className:"stock-notification",children:["Notify me when stock drops below:",Object($.jsx)("input",{className:"text-center",type:"text",name:"minimum",placeholder:"#",defaultValue:s?s.minimum:""})]})}),Object($.jsxs)("div",{className:"button-area",children:[Object($.jsx)("button",{className:"btn-form",type:"submit",children:"Save"}),Object($.jsx)("button",{className:"btn-form",onClick:function(){e.removeQueries("selectedPart"),e.setQueryData("view","inventory")},children:"Cancel"}),s&&s._id?Object($.jsx)("button",{className:"btn-form delete",onClick:function(){var c;c=s._id,window.confirm("Are you sure you want to delete?\nThis cannot be undone.")&&n.mutate(c),t("Part Deleted"),e.removeQueries("selectedCustomer"),e.removeQueries("selectedJob"),e.setQueryData("view","inventory")},children:"Delete"}):Object($.jsx)($.Fragment,{})]})]})})},Qe=function(){var e=_().user,t=q(),s=t.status,c=t.data,r=t.error,a=J("view");if(!e)return Object($.jsx)(R.a,{to:"/"});switch(s){case"loading":return Object($.jsx)("h1",{className:"text-center",children:"Loading"});case"error":return Object($.jsxs)("h4",{className:"text-center",children:["Error: ",r.message]});default:return"restock"===a?Object($.jsxs)("main",{className:"container",children:[Object($.jsx)(ge,{}),Object($.jsx)(Ce,{parts:c.data})]}):"newPart"===a?Object($.jsxs)("main",{className:"container",children:[Object($.jsx)(ge,{}),Object($.jsx)(De,{})]}):Object($.jsxs)("main",{className:"container",children:[Object($.jsx)(ge,{}),Object($.jsx)(we,{parts:c.data})]})}},ke=function(){return Object($.jsx)(U.a,{children:Object($.jsxs)(R.d,{children:[Object($.jsx)(R.b,{exact:!0,path:"/",component:G}),Object($.jsx)(R.b,{exact:!0,path:"/login",component:G}),Object($.jsxs)($.Fragment,{children:[Object($.jsx)(ie,{}),Object($.jsx)(R.b,{exact:!0,path:"/register",component:Z}),Object($.jsx)(R.b,{exact:!0,path:"/dashboard",component:Oe}),Object($.jsx)(R.b,{exact:!0,path:"/customers",component:Ne}),Object($.jsx)(R.b,{exact:!0,path:"/service",component:xe}),Object($.jsx)(R.b,{exact:!0,path:"/inventory",component:Qe})]})]})})},Se=(s(111),function(){return Object($.jsxs)(u.QueryClientProvider,{client:I,children:[Object($.jsx)(ke,{}),Object($.jsx)(le,{}),Object($.jsx)(i.ReactQueryDevtools,{})]})});n.a.render(Object($.jsx)(r.a.StrictMode,{children:Object($.jsx)(Se,{})}),document.getElementById("root"))},99:function(e,t,s){}},[[112,1,2]]]);
//# sourceMappingURL=main.c4c2583a.chunk.js.map