(this.webpackJsonpmetronics=this.webpackJsonpmetronics||[]).push([[0],{106:function(e,t,s){},107:function(e,t,s){},108:function(e,t,s){},109:function(e,t,s){},110:function(e,t,s){},111:function(e,t,s){},112:function(e,t,s){},113:function(e,t,s){},114:function(e,t,s){},115:function(e,t,s){"use strict";s.r(t);var c=s(1),r=s.n(c),a=s(37),n=s.n(a),i=s(62),u=s(3),o=s(5),l=s.n(o),d=s(9),j=s(11),b=s.n(j),m=function(){return JSON.parse(localStorage.getItem("metronics"))},h=function(){localStorage.removeItem("metronics")},O="https://metronics-webapp-server.herokuapp.com/api/customers",x="https://metronics-webapp-server.herokuapp.com/api/jobs",f="https://metronics-webapp-server.herokuapp.com/api/parts",p="https://metronics-webapp-server.herokuapp.com/api/messages",v="https://metronics-webapp-server.herokuapp.com/api/requests",y="https://metronics-webapp-server.herokuapp.com/api/users",N="https://metronics-webapp-server.herokuapp.com/api/auth",g=function(){var e=m().token;if(e)return{metronics:e}},w={getCustomers:function(){return b.a.get(O,{headers:g()})},createCustomer:function(e){return b.a.post(O,e,{headers:g()})},updateCustomer:function(e,t){return b.a.put("".concat(O,"/").concat(e),t,{headers:g()})},deleteCustomer:function(e){return b.a.delete("".concat(O,"/").concat(e),{headers:g()})},getJobs:function(){return b.a.get(x,{headers:g()})},createJob:function(e){return b.a.post(x,e,{headers:g()})},updateJob:function(e,t){return b.a.put("".concat(x,"/").concat(e),t,{headers:g()})},deleteJob:function(e){return b.a.delete("".concat(x,"/").concat(e),{headers:g()})},deleteJobsByCustomerId:function(e){return b.a.delete("".concat(x,"/clear/").concat(e),{headers:g()})},getParts:function(){return b.a.get(f,{headers:g()})},createPart:function(e){return b.a.post(f,e,{headers:g()})},updatePart:function(e,t){return b.a.put("".concat(f,"/").concat(e),t,{headers:g()})},deletePart:function(e){return b.a.delete("".concat(f,"/").concat(e),{headers:g()})},getMessages:function(){return b.a.get(p,{headers:g()})},updateMessage:function(e,t){return b.a.put("".concat(p,"/").concat(e),t,{headers:g()})},deleteMessage:function(e){return b.a.delete("".concat(p,"/").concat(e),{headers:g()})},getRequests:function(){return b.a.get(v,{headers:g()})},deleteRequest:function(e){return b.a.delete("".concat(v,"/").concat(e),{headers:g()})},getUser:function(e){return b.a.get("".concat(y,"/").concat(e),{headers:g()})},updateUser:function(e,t){return b.a.put("".concat(y,"/").concat(e),t,{headers:g()})},deleteUser:function(e){return b.a.delete("".concat(y,"/").concat(e),{headers:g()})},login:function(e){return b.a.post("".concat(N,"/login"),e)},register:function(e){return b.a.post("".concat(N,"/register"),e,{headers:g()})}},C=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.getCustomers();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0.message),window.location.reload();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),D=function(){return Object(u.useQuery)("customers",(function(){return C()}))},Q=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.getJobs();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0.message),window.location.reload();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),k=function(){return Object(u.useQuery)("jobs",(function(){return Q()}))},S=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.getParts();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0.message),window.location.reload();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),F=function(){return Object(u.useQuery)("parts",(function(){return S()}))},P=s(6),q=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.getUser(t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),h(),console.error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(u.useQueryClient)(),t=Object(c.useState)(m()),s=Object(P.a)(t,2),r=s[0],a=s[1];Object(u.useQuery)("user",(function(){return q(r._id)}),{enabled:!!r,onSuccess:function(e){a({_id:e.data._id,username:e.data.username})}});return{user:r,updateUser:function(t){a({_id:t._id,username:t.username}),e.setQueryData("user",r)},clearUser:function(){a(null),e.setQueryData("user",null),e.removeQueries(["user","jobs","customers","parts"])}}},M=function(){var e=L(),t=(e.updateUser,e.clearUser),s=function(){var e=Object(d.a)(l.a.mark((function e(t,s){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.login(t,s);case 3:(c=e.sent).data&&(r={_id:c.data._id,token:c.data.token},localStorage.setItem("metronics",JSON.stringify(r))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0.message);case 10:case"end":return e.stop()}var r}),e,null,[[0,7]])})));return function(t,s){return e.apply(this,arguments)}}(),c=function(){var e=Object(d.a)(l.a.mark((function e(t){var s,c,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.username,c=t.password,r={username:s,password:c},e.prev=2,e.next=5,w.register(r);case 5:return a=e.sent,e.abrupt("return",a);case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}();return{login:s,register:c,logout:function(){h(),t()}}},_=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.getMessages();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0.message),window.location.reload();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),T=function(){return Object(u.useQuery)("messages",(function(){return _()}))},E=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.getRequests();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0.message),window.location.reload();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),V=function(){return Object(u.useQuery)("requests",(function(){return E()}))},Y=new u.QueryClient({defaultOptions:{queries:{staleTime:6e5,cacheTime:9e5,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1}}}),I=function(e){var t=Object(u.useQuery)(e,(function(){})).data;return void 0===t?null:t},J=s(65),A=function(){var e=Object(u.useQueryClient)(),t=I("toasts");Object(c.useEffect)((function(){if(t){t.length>5&&e.setQueryData("toasts",t.slice(1));var s=setInterval((function(){e.setQueryData("toasts",t.slice(1))}),3e3);return function(){return clearInterval(s)}}}),[t]);return{toasts:t,addToast:function(s){var c={id:Math.floor(1e3*Math.random()),msg:s};t?e.setQueryData("toasts",[].concat(Object(J.a)(t),[c])):e.setQueryData("toasts",[c])},deleteToast:function(s){e.setQueryData("toasts",t.filter((function(e){return e.id!==s})))}}},B=s(24),U=s(14),R=s(12),z=s(13),H=(s(99),s(0)),$=function(){var e=Object(u.useQueryClient)(),t=M().logout,s=Object(U.g)(),r=Object(c.useState)(""),a=Object(P.a)(r,2),n=a[0],i=a[1],o=I("view");Object(c.useEffect)((function(){var e=window.location.pathname;i(e)}),[o]),Object(c.useEffect)((function(){var e,t=document.querySelectorAll("svg"),s=Object(B.a)(t);try{for(s.s();!(e=s.n()).done;){e.value.classList.remove("active")}}catch(c){s.e(c)}finally{s.f()}switch(n){case"/dashboard":t[0].classList.add("active");break;case"/customers":t[1].classList.add("active");break;case"/service":t[2].classList.add("active");break;case"/inventory":t[3].classList.add("active")}}),[n]);return Object(H.jsx)("header",{children:Object(H.jsxs)("nav",{className:"navbar",children:[Object(H.jsxs)("ul",{children:[Object(H.jsx)("li",{className:"nav-item",onClick:function(){e.setQueryData("view","default"),i("/dashboard"),s.push("/dashboard")},children:Object(H.jsx)(R.a,{icon:z.e})}),Object(H.jsx)("li",{className:"nav-item",onClick:function(){e.setQueryData("view","default"),i("/customers"),s.push("/customers")},children:Object(H.jsx)(R.a,{icon:z.k})}),Object(H.jsx)("li",{className:"nav-item",onClick:function(){e.setQueryData("view","default"),i("/service"),s.push("/service")},children:Object(H.jsx)(R.a,{icon:z.i})}),Object(H.jsx)("li",{className:"nav-item",onClick:function(){e.setQueryData("view","default"),i("/inventory"),s.push("/inventory")},children:Object(H.jsx)(R.a,{icon:z.l})})]}),Object(H.jsx)("button",{className:"signOut",onClick:function(){t(),s.push("/login"),window.location.reload()},children:Object(H.jsx)(R.a,{icon:z.h})})]})})},G=(s(106),function(e){var t=e.placeholder,s=e.setSearch;return Object(H.jsxs)("div",{className:"searchbar",children:[Object(H.jsx)(R.a,{className:"faSearch",icon:z.g}),Object(H.jsx)("input",{className:"search",name:"search",onChange:function(e){e.preventDefault(),s(e.currentTarget.value)},type:"text",placeholder:t})]})}),Z=(s(107),function(){var e,t=Object(u.useQueryClient)(),s=D().data,r=Object(c.useState)(0),a=Object(P.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)([]),l=Object(P.a)(o,2),d=l[0],j=l[1],b=Object(c.useState)(!1),m=Object(P.a)(b,2),h=m[0],O=m[1],x=Object(c.useState)(""),f=Object(P.a)(x,2),p=f[0],v=f[1],y=function(e){var c=s.data.filter((function(t){return t._id===e.target.dataset.id}));t.setQueryData("submissionType","add"),t.setQueryData("selectedCustomer",c[0]),v(c[0].businessName),i(0),j([]),O(!1)};return h&&p&&d.length&&(e=Object(H.jsx)("ul",{className:"suggestions",children:d.map((function(e,t){var s;return t===n&&(s="suggestion-active"),Object(H.jsxs)("li",{className:s,"data-id":e._id,onClick:y,children:[e.businessName," - ",e.address.street1,", ",e.address.city]},e._id)}))})),Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)("input",{type:"text",placeholder:"Business Name",name:"businessName",onChange:function(e){var t=s.data,c=e.target.value,r=t.filter((function(e){return e.businessName.toLowerCase().indexOf(c.toLowerCase())>-1}));i(0),j(r),O(!0),v(e.target.value)},value:p,required:!0}),d.length?e:""]})}),W=(s(108),function(){var e=A(),t=e.toasts,s=e.deleteToast,r=Object(c.useState)([]),a=Object(P.a)(r,2),n=a[0],i=a[1];return Object(c.useEffect)((function(){t&&i(t)}),[t]),Object(H.jsx)("footer",{className:"toast-container",children:n.map((function(e){return Object(H.jsxs)("div",{className:"toast-card",children:[Object(H.jsx)("button",{onClick:function(){return s(e.id)},children:"X"}),Object(H.jsx)("p",{className:"toast-message",children:e.msg})]},e.id)}))})}),X=s(22),K=(s(109),function(){var e=L().user,t=M().login,s=Object(U.g)();if(e)return Object(H.jsx)(U.a,{to:"/dashboard"});var c=function(){var e=Object(d.a)(l.a.mark((function e(c){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c.preventDefault(),r=Object.fromEntries(new FormData(c.target)),a={username:r.username,password:r.password},e.next=6,t(a);case 6:s.push("/dashboard"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsx)("main",{children:Object(H.jsxs)("div",{id:"card-login",children:[Object(H.jsx)("h1",{children:"Metronics"}),Object(H.jsxs)("form",{id:"form-login",onSubmit:c,children:[Object(H.jsx)(R.a,{className:"icon-faUser",icon:z.j}),Object(H.jsxs)("label",{children:["Username",Object(H.jsx)("input",{type:"text",name:"username",defaultValue:"admin",required:!0})]}),Object(H.jsx)(R.a,{className:"icon-faLock",icon:z.f}),Object(H.jsxs)("label",{children:["Password",Object(H.jsx)("input",{type:"password",name:"password",defaultValue:"metronicsAdmin",required:!0})]}),Object(H.jsx)("button",{className:"btn-login",type:"submit",children:"LOGIN"})]})]})})}),ee=function(){var e=M().register,t=Object(U.g)(),s=function(){var s=Object(d.a)(l.a.mark((function s(c){var r;return l.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,c.preventDefault(),r=Object.fromEntries(new FormData(c.target)),s.next=5,e({username:r.username,password:r.password});case 5:201===s.sent.status&&t.push("/dashboard"),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(0),console.error(s.t0);case 12:case"end":return s.stop()}}),s,null,[[0,9]])})));return function(e){return s.apply(this,arguments)}}();return Object(H.jsx)("main",{children:Object(H.jsxs)("div",{id:"card-login",children:[Object(H.jsx)("h1",{children:"Metronics"}),Object(H.jsxs)("form",{id:"form-login",onSubmit:s,children:[Object(H.jsx)(R.a,{className:"icon-faUser",icon:z.j}),Object(H.jsxs)("label",{children:["Username",Object(H.jsx)("input",{type:"text",name:"username",required:!0})]}),Object(H.jsx)(R.a,{className:"icon-faLock",icon:z.f}),Object(H.jsxs)("label",{children:["Password",Object(H.jsx)("input",{type:"password",name:"password",required:!0})]}),Object(H.jsx)("button",{className:"btn-login",type:"submit",children:"REGISTER"})]})]})})},te=function(){var e=Object(u.useQueryClient)();return Object(H.jsxs)("div",{className:"main-header",children:[Object(H.jsx)("h1",{onClick:function(){e.setQueryData("view","default")},children:"Dashboard"}),Object(H.jsxs)("div",{className:"button-area",children:[Object(H.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","overview")},children:"Overview"}),Object(H.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","messages")},children:"View Messages"})]})]})},se=s(15),ce=s(10),re=s.n(ce),ae=function(e){var t=e.messages,s=Object(u.useQueryClient)(),r=Object(c.useState)(t),a=Object(P.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(!1),j=Object(P.a)(o,2),b=j[0],m=j[1];Object(c.useEffect)((function(){i(!1===b?t.filter((function(e){return!1===e.read})):t.filter((function(e){return!0===e.read})))}),[b,t]);var h=Object(u.useMutation)((function(e){return w.updateMessage(e.id,e.data)}),{onSuccess:function(){s.invalidateQueries("messages")}}),O=function(){var e=Object(d.a)(l.a.mark((function e(t){var s,c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),s=document.getElementsByClassName("toggle-btn"),c=Object(B.a)(s);try{for(c.s();!(r=c.n()).done;)r.value.classList.remove("active")}catch(a){c.e(a)}finally{c.f()}t.currentTarget.classList.add("active"),"Read"===t.currentTarget.innerHTML?m(!0):m(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)("section",{className:"section-messages",children:[Object(H.jsxs)("div",{className:"read-toggle",children:[Object(H.jsx)("div",{className:"toggle-btn left active",onClick:function(e){return O(e)},children:"Unread"}),Object(H.jsx)("div",{className:"toggle-btn right",onClick:function(e){return O(e)},children:"Read"})]}),n.map((function(e){return Object(H.jsxs)("div",{className:"message",children:[Object(H.jsxs)("div",{className:"msg-header",children:[Object(H.jsxs)("p",{children:["From: ",Object(H.jsx)("strong",{children:e.name})]}),Object(H.jsx)("p",{children:e.email}),Object(H.jsx)("p",{children:re()(e.createdAt).format("MMM D, YYYY")})]}),Object(H.jsx)("p",{children:e.message}),Object(H.jsx)("p",{className:"mark-read text-right",onClick:function(){return function(e){var t=!1===e.read;h.mutate({id:e._id,data:Object(se.a)(Object(se.a)({},e),{},{read:t})})}(e)},children:!1===e.read?"Mark as read":"Mark as unread"})]},e._id)})),n.length<1?Object(H.jsx)("p",{className:"empty",children:"** No messages to display **"}):Object(H.jsx)(H.Fragment,{})]})},ne=function(e){var t=e.jobs,s=Object(u.useQueryClient)(),r=Object(c.useState)([]),a=Object(P.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)([]),l=Object(P.a)(o,2),d=l[0],j=l[1],b=re()(new Date);Object(c.useEffect)((function(){i(t.filter((function(e){return"Canceled"!==e.status}))),j((function(){for(var e=[],t=0;t<5;t++)e.push({name:re()(b).add(t,"day").format("dddd"),number:re()(b).add(t,"day").format("DD")});return e}))}),[t]);return Object(H.jsxs)("section",{className:"section-calendar",children:[Object(H.jsx)("h2",{children:"5 DAY SCHEDULE"}),Object(H.jsx)("div",{className:"upcoming",children:d.map((function(e){return Object(H.jsxs)("div",{className:"card-day",children:[Object(H.jsxs)("h3",{children:[Object(H.jsx)("span",{children:e.name}),Object(H.jsx)("span",{children:e.number})]}),Object(H.jsx)("div",{children:n.filter((function(t){return re()(t.serviceDate).format("dddd")===e.name&&re()(t.serviceDate)>b.subtract(1,"day")&&re()(t.serviceDate)<b.add(5,"day")})).sort((function(e,t){return e.customer.address.city.charCodeAt(0)-t.customer.address.city.charCodeAt(0)})).map((function(e){return Object(H.jsxs)("p",{onClick:function(){return function(e){s.setQueryData("submissionType","edit"),s.setQueryData("selectedJob",e),s.setQueryData("selectedCustomer",e.customer),s.setQueryData("view","serviceForm")}(e)},children:[e.customer.businessName,Object(H.jsx)("br",{}),Object(H.jsx)("span",{children:e.customer.address.city})]},e._id)}))})]},e.number)}))})]})},ie=function(e){var t=e.jobs,s=e.requests,c=e.messages,r=e.parts,a=Object(u.useQueryClient)(),n=Object(U.g)();return Object(H.jsxs)("section",{className:"section-notifications",children:[Object(H.jsx)("h2",{children:"NOTIFICATIONS"}),Object(H.jsxs)("div",{children:[t.length?Object(H.jsx)("p",{className:"notice",onClick:function(){a.setQueryData("view","all"),n.push("/service")},children:"There are new jobs that need to be scheduled."}):Object(H.jsx)(H.Fragment,{}),s.length?Object(H.jsx)("p",{className:"notice",onClick:function(){a.setQueryData("view","requests"),n.push("/service")},children:"There are new online requests awaiting your review."}):Object(H.jsx)(H.Fragment,{}),c.length?Object(H.jsx)("p",{className:"notice",onClick:function(){a.setQueryData("view","messages")},children:"You have unread messages in your inbox."}):Object(H.jsx)(H.Fragment,{}),r.length?Object(H.jsx)("p",{className:"notice",onClick:function(){a.setQueryData("view","restock"),n.push("/inventory")},children:"Some parts need to be re-ordered."}):Object(H.jsx)(H.Fragment,{}),r.length||t.length||s.length||c.length?Object(H.jsx)(H.Fragment,{}):Object(H.jsx)("p",{className:"empty-notifications",children:"** You're all caught up. **"})]})]})},ue=function(e){var t=e.jobs,s=Object(u.useQueryClient)(),r=Object(U.g)(),a=Object(c.useState)(0),n=Object(P.a)(a,2),i=n[0],o=n[1],l=Object(c.useState)(0),d=Object(P.a)(l,2),j=d[0],b=d[1],m=re()(new Date).format("YYYY"),h=Intl.NumberFormat("en-US");return Object(c.useEffect)((function(){var e,s=0,c=0,r=Object(B.a)(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;re()(a.serviceDate).format("YYYY")===m&&a.isPaid&&(s+=a.totalBill),re()(a.serviceDate).format("YYYY")<=m&&!a.isPaid&&(c+=a.totalBill)}}catch(n){r.e(n)}finally{r.f()}o(h.format(s)),b(h.format(c))}),[t]),Object(H.jsxs)("section",{className:"section-revenue",children:[Object(H.jsx)("h2",{children:"YTD SERVICE REVENUE"}),Object(H.jsxs)("p",{className:"revenue",children:["$",i]}),Object(H.jsxs)("p",{className:"outstanding",onClick:function(){s.setQueryData("view","unpaid"),r.push("/service")},children:["$",j," outstanding"]})]})},oe=function(){var e=Object(u.useQueryClient)(),t=I("view");return Object(H.jsxs)("div",{className:"main-header",children:[Object(H.jsx)("h1",{onClick:function(){return window.location.reload()},children:"Service Jobs"}),Object(H.jsxs)("div",{className:"button-area",children:[Object(H.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","default")},children:"View All"}),Object(H.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","requests")},children:"View Online Requests"}),Object(H.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","unpaid")},children:"View Unpaid"}),Object(H.jsx)("p",{className:"btn",onClick:function(){if(e.setQueryData("selectedCustomer",null),e.setQueryData("selectedJob",null),e.setQueryData("submissionType","new"),"serviceForm"===t){var s,c=document.querySelectorAll("input, textarea"),r=Object(B.a)(c);try{for(r.s();!(s=r.n()).done;){s.value.value=""}}catch(a){r.e(a)}finally{r.f()}}else e.setQueryData("view","serviceForm")},children:"Create New"})]})]})},le=function(e){for(var t=0;t<e.length;t++)"Pending"===e[t].status&&e.unshift(e.splice(t,1)[0]);return e},de=function(e){var t=e.jobs,s=Object(u.useQueryClient)(),r=Object(c.useState)([]),a=Object(P.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(""),l=Object(P.a)(o,2),d=l[0],j=l[1],b=Object(c.useState)(""),m=Object(P.a)(b,2),h=m[0],O=m[1];return Object(c.useEffect)((function(){var e=le(t);i("Pending"===d?e.filter((function(e){return"Pending"===e.status})):"Scheduled"===d?e.filter((function(e){return"Scheduled"===e.status})):"Completed"===d?e.filter((function(e){return"Completed"===e.status})):"Canceled"===d?e.filter((function(e){return"Canceled"===e.status})):e)}),[d,t]),Object(c.useEffect)((function(){var e=le(t);i(""!==h?e.filter((function(e){return e.customer.businessName.toLowerCase().includes(h.toLowerCase())||e.customer.address.city.toLowerCase().includes(h.toLowerCase())||null!==e.serviceDate&&e.serviceDate.includes(h)||null!==e.invoiceNumber&&e.invoiceNumber.includes(h)})):e)}),[h,t]),Object(H.jsxs)("section",{children:[Object(H.jsxs)("div",{className:"section-header",children:[Object(H.jsx)("div",{children:Object(H.jsx)(G,{placeholder:"Search",setSearch:O})}),Object(H.jsxs)("div",{className:"dropdown",children:[Object(H.jsx)(R.a,{className:"faChevronDown",icon:z.a}),Object(H.jsxs)("select",{onChange:function(e){return j(e.target.value)},children:[Object(H.jsx)("option",{children:"Filter by status"}),Object(H.jsx)("option",{children:"Pending"}),Object(H.jsx)("option",{children:"Scheduled"}),Object(H.jsx)("option",{children:"Completed"}),Object(H.jsx)("option",{children:"Canceled"})]})]})]}),Object(H.jsxs)("table",{children:[Object(H.jsx)("thead",{children:Object(H.jsxs)("tr",{className:"tr-job",children:[Object(H.jsx)("th",{className:"text-center",children:"Service Date"}),Object(H.jsx)("th",{children:"Business Name"}),Object(H.jsx)("th",{children:"City"}),Object(H.jsx)("th",{className:"text-center",children:"Invoice #"}),Object(H.jsx)("th",{className:"text-center",children:"Status"})]})}),Object(H.jsx)("tbody",{children:n.map((function(e){return Object(H.jsxs)("tr",{className:"table-item tr-job clickable",onClick:function(){s.setQueryData("submissionType","edit"),s.setQueryData("selectedJob",e),s.setQueryData("selectedCustomer",e.customer),s.setQueryData("view","serviceForm")},children:[Object(H.jsx)("td",{className:"text-center",children:e.serviceDate?re()(e.serviceDate).format("MMM D, YYYY"):"--"}),Object(H.jsx)("td",{children:e.customer.businessName}),Object(H.jsx)("td",{children:e.customer.address.city}),Object(H.jsx)("td",{className:"text-center",children:e.invoiceNumber?e.invoiceNumber:"--"}),Object(H.jsx)("td",{className:"text-center",children:e.status})]},e._id)}))})]}),n.length<1?Object(H.jsx)("p",{className:"empty",children:"** No jobs to display **"}):Object(H.jsx)(H.Fragment,{})]})},je=function(e){var t=e.requests,s=Object(u.useQueryClient)(),r=Object(c.useState)([]),a=Object(P.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(""),l=Object(P.a)(o,2),d=l[0],j=l[1];return Object(c.useEffect)((function(){i(t.filter((function(e){return e.customer.businessName.toLowerCase().includes(d.toLowerCase())||e.customer.address.city.toLowerCase().includes(d.toLowerCase())||e.customer.contactName.toLowerCase().includes(d.toLowerCase())||e.customer.phone.includes(d)})))}),[d,t]),Object(H.jsxs)("section",{children:[Object(H.jsx)("div",{className:"section-header",children:Object(H.jsx)("div",{children:Object(H.jsx)(G,{placeholder:"Search",setSearch:j})})}),Object(H.jsxs)("table",{children:[Object(H.jsx)("thead",{children:Object(H.jsxs)("tr",{className:"tr-job",children:[Object(H.jsx)("th",{className:"text-center",children:"Date Submitted"}),Object(H.jsx)("th",{children:"Business Name"}),Object(H.jsx)("th",{children:"City"}),Object(H.jsx)("th",{className:"text-center",children:"Contact Name"}),Object(H.jsx)("th",{className:"text-center",children:"Phone #"})]})}),Object(H.jsx)("tbody",{children:n.map((function(e){return Object(H.jsxs)("tr",{className:"table-item tr-job clickable",onClick:function(){s.setQueryData("submissionType","new"),s.setQueryData("selectedJob",{_id:e._id,status:"Pending",issueNotes:e.issueNotes}),s.setQueryData("selectedCustomer",e.customer),s.setQueryData("view","serviceForm"),s.setQueryData("deleteRequest",!0)},children:[Object(H.jsx)("td",{className:"text-center",children:re()(e.createdAt).format("MMM D, YYYY")}),Object(H.jsx)("td",{children:e.customer.businessName}),Object(H.jsxs)("td",{children:[e.customer.address.city,", ",e.customer.address.state]}),Object(H.jsx)("td",{className:"text-center",children:e.customer.contactName}),Object(H.jsx)("td",{className:"text-center",children:e.customer.phone})]},e._id)}))})]}),n.length<1?Object(H.jsx)("p",{className:"empty",children:"** No online requests to display **"}):Object(H.jsx)(H.Fragment,{})]})},be=function(e){var t=e.jobs,s=Object(u.useQueryClient)(),r=Object(c.useState)([]),a=Object(P.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(""),l=Object(P.a)(o,2),d=l[0],j=l[1],b=Intl.NumberFormat("en-US");Object(c.useEffect)((function(){i(""===d?t.filter((function(e){return!e.isPaid&&"Completed"===e.status})):n.filter((function(e){return e.customer.businessName.toLowerCase().includes(d.toLowerCase())||e.customer.address.city.toLowerCase().includes(d.toLowerCase())||e.customer.contactName.toLowerCase().includes(d.toLowerCase())||e.customer.phone.includes(d)})))}),[d,t]);var m=Object(u.useMutation)((function(e){return w.updateJob(e.id,e.data)}),{onSuccess:function(){s.invalidateQueries("jobs")}});return Object(H.jsxs)("section",{children:[Object(H.jsx)("div",{className:"section-header",children:Object(H.jsx)("div",{children:Object(H.jsx)(G,{placeholder:"Search",setSearch:j})})}),Object(H.jsxs)("table",{children:[Object(H.jsx)("thead",{children:Object(H.jsxs)("tr",{className:"tr-job",children:[Object(H.jsx)("th",{className:"text-center",children:"Service Date"}),Object(H.jsx)("th",{children:"Business Name"}),Object(H.jsx)("th",{className:"text-center",children:"Invoice #"}),Object(H.jsx)("th",{className:"text-center",children:"Total Bill"}),Object(H.jsx)("th",{})]})}),Object(H.jsx)("tbody",{children:n.map((function(e){return Object(H.jsxs)("tr",{className:"table-item tr-job",children:[Object(H.jsx)("td",{className:"text-center",children:e.serviceDate?re()(e.serviceDate).format("MMM D, YYYY"):"--"}),Object(H.jsx)("td",{children:e.customer.businessName}),Object(H.jsx)("td",{className:"text-center",children:e.invoiceNumber?e.invoiceNumber:"--"}),Object(H.jsxs)("td",{className:"text-center",children:["$ ",b.format(e.totalBill)]}),Object(H.jsx)("td",{className:"mark-paid text-center",onClick:function(){return function(e){m.mutate({id:e._id,data:Object(se.a)(Object(se.a)({},e),{},{isPaid:!0})})}(e)},children:"Mark as paid"})]},e._id)}))})]}),n.length<1?Object(H.jsx)("p",{className:"empty",children:"** No unpaid jobs to display **"}):Object(H.jsx)(H.Fragment,{})]})},me=function(){var e=Object(u.useQueryClient)(),t=D(),s=t.status,r=t.data,a=t.error,n=A().addToast,i=I("existingCustomer"),o=I("deleteRequest"),j=I("submissionType"),b=I("selectedCustomer"),m=I("selectedJob"),h=I("view"),O=Intl.NumberFormat("en-US");Object(c.useEffect)((function(){if("success"===s&&"requests"===h){var t=r.data.filter((function(e){return b.address.street1.toLowerCase()===e.address.street1.toLowerCase()&&b.address.city.toLowerCase()===e.address.city.toLowerCase()}));t.length>0&&e.setQueryData("existingCustomer",t[0])}}),[]);var x=Object(u.useMutation)((function(e){return w.createJob(e)}),{onSuccess:function(){e.invalidateQueries("jobs")}}),f=Object(u.useMutation)((function(e){return w.updateJob(e.id,e.data)}),{onSuccess:function(){e.invalidateQueries("jobs")}}),p=Object(u.useMutation)((function(e){return w.deleteJob(e)}),{onSuccess:function(){e.invalidateQueries("jobs")}}),v=Object(u.useMutation)((function(e){return w.createCustomer(e)}),{onSuccess:function(){e.invalidateQueries("customers")}}),y=Object(u.useMutation)((function(e){return w.updateCustomer(e.id,e.data)}),{onSuccess:function(){e.invalidateQueries("customers")}}),N=Object(u.useMutation)((function(e){return w.deleteRequest(e)}),{onSuccess:function(){e.invalidateQueries("requests")}}),g=function(e){N.mutate(e)},C=function(){var t=Object(d.a)(l.a.mark((function t(s){var c,r,a,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s.preventDefault(),t.prev=1,c=Object.fromEntries(new FormData(s.target)),r={status:c.status,serviceDate:c.serviceDate,invoiceNumber:c.invoiceNumber.trim(),issueNotes:c.issueNotes.trim(),serviceNotes:c.serviceNotes.trim(),totalBill:parseFloat(c.totalBill.trim()),isPaid:"on"===c.isPaid},a={businessName:c.businessName.trim(),contactName:c.contactName.trim(),phone:c.phone.trim(),address:{street1:c.street1.trim(),street2:c.street2.trim(),city:c.city.trim(),state:c.state.trim(),zipcode:c.zipcode.trim()}},"add"!==j){t.next=15;break}if(y.mutate({id:b._id,data:a}),x.mutate(Object(se.a)({customer:b._id},r)),!o){t.next=13;break}return g(m._id),e.setQueryData("deleteRequest",null),e.setQueryData("view","requests"),t.abrupt("return");case 13:return e.setQueryData("view","default"),t.abrupt("return");case 15:if("edit"!==j){t.next=20;break}return y.mutate({id:b._id,data:a}),f.mutate({id:m._id,data:r}),e.setQueryData("view","default"),t.abrupt("return");case 20:if("new"!==j){t.next=31;break}return t.next=23,v.mutateAsync(a);case 23:if(n=t.sent,x.mutate(Object(se.a)({customer:n.data._id},r)),!o){t.next=30;break}return g(m._id),e.setQueryData("deleteRequest",null),e.setQueryData("view","requests"),t.abrupt("return");case 30:e.setQueryData("view","default");case 31:t.next=36;break;case 33:t.prev=33,t.t0=t.catch(1),console.error(t.t0);case 36:case"end":return t.stop()}}),t,null,[[1,33]])})));return function(e){return t.apply(this,arguments)}}();switch(s){case"loading":return Object(H.jsx)("h1",{children:"Loading"});case"error":return Object(H.jsxs)("h4",{children:["Error: ",a.message]});default:return i?Object(H.jsx)("section",{children:Object(H.jsxs)("div",{className:"use-existing-customer",children:[Object(H.jsx)("h4",{children:"The address matches an existing customer:"}),Object(H.jsxs)("p",{className:"match",children:[Object(H.jsx)("strong",{children:i.businessName}),Object(H.jsx)("br",{}),i.address.street1," ",i.address.street2?", "+i.address.street2:Object(H.jsx)(H.Fragment,{}),Object(H.jsx)("br",{}),i.address.city,", ",i.address.state," ",i.address.zipcode]}),Object(H.jsxs)("div",{children:[Object(H.jsxs)("p",{children:["Add this job to ",Object(H.jsx)("strong",{children:i.businessName}),"?"]}),Object(H.jsx)("button",{onClick:function(){e.setQueryData("submissionType","add"),e.setQueryData("selectedCustomer",Object(se.a)(Object(se.a)({},b),{},{_id:i._id,businessName:i.businessName,address:i.address})),e.setQueryData("existingCustomer",null)},children:"Yes"}),Object(H.jsx)("button",{onClick:function(){return e.setQueryData("existingCustomer",null)},children:"No"})]})]})}):Object(H.jsx)("section",{children:Object(H.jsxs)("form",{id:"form-service",onSubmit:C,children:[Object(H.jsxs)("div",{className:"job-area",children:[Object(H.jsxs)("label",{children:["Service Date",Object(H.jsx)("input",{className:"input-sm",type:"date",name:"serviceDate",defaultValue:m?m.serviceDate:""})]}),Object(H.jsxs)("label",{children:["Status",Object(H.jsxs)("div",{className:"dropdown",children:[Object(H.jsx)(R.a,{className:"faChevronDown",icon:z.a}),Object(H.jsxs)("select",{name:"status",children:[m?Object(H.jsx)("option",{children:m.status}):Object(H.jsx)(H.Fragment,{}),m&&"Pending"===m.status?"":Object(H.jsx)("option",{children:"Pending"}),m&&"Scheduled"===m.status?"":Object(H.jsx)("option",{children:"Scheduled"}),m&&"Completed"===m.status?"":Object(H.jsx)("option",{children:"Completed"}),m&&"Canceled"===m.status?"":Object(H.jsx)("option",{children:"Canceled"})]})]})]}),Object(H.jsxs)("label",{children:["Invoice",Object(H.jsxs)("div",{className:"invoiceInput",children:[Object(H.jsx)(R.a,{className:"faHashtag",icon:z.d}),Object(H.jsx)("input",{type:"text",name:"invoiceNumber",defaultValue:m?m.invoiceNumber:""})]})]}),Object(H.jsxs)("label",{children:["Total Bill",Object(H.jsxs)("div",{className:"dollarInput",children:[Object(H.jsx)(R.a,{className:"faDollarSign",icon:z.b}),Object(H.jsx)("input",{type:"text",name:"totalBill",defaultValue:m?O.format(m.totalBill):"0"})]})]}),Object(H.jsxs)("label",{className:"text-center",children:["Paid?",Object(H.jsx)("input",{className:"checkbox",type:"checkbox",name:"isPaid",defaultChecked:m&&!0===m.isPaid?"on":void 0})]})]}),Object(H.jsxs)("div",{className:"customer-area",children:[Object(H.jsx)("div",{children:Object(H.jsxs)("label",{children:["Contact Information","requests"!==h&&i?Object(H.jsx)(Z,{}):Object(H.jsx)("input",{type:"text",name:"businessName",placeholder:"Business Name",required:!0,defaultValue:b?b.businessName:""}),Object(H.jsx)("input",{type:"text",name:"contactName",placeholder:"Contact Person",defaultValue:b?b.contactName:""}),Object(H.jsx)("input",{type:"text",name:"phone",placeholder:"Phone #",required:!0,defaultValue:b?b.phone:""})]})}),Object(H.jsx)("div",{children:Object(H.jsxs)("label",{className:"address",children:["Address",Object(H.jsx)("input",{type:"text",name:"street1",placeholder:"Street Address",required:!0,defaultValue:b?b.address.street1:""}),Object(H.jsx)("input",{type:"text",name:"street2",placeholder:"Unit or Building #",defaultValue:b?b.address.street2:""}),Object(H.jsxs)("div",{children:[Object(H.jsx)("input",{type:"text",name:"city",placeholder:"City",required:!0,defaultValue:b?b.address.city:""}),Object(H.jsx)("input",{className:"text-center",type:"text",name:"state",defaultValue:"CA",required:!0}),Object(H.jsx)("input",{type:"text",name:"zipcode",placeholder:"Zip Code",required:!0,defaultValue:b?b.address.zipcode:""})]})]})})]}),Object(H.jsxs)("div",{className:"notes-area",children:[Object(H.jsxs)("label",{children:["Description of Problem",Object(H.jsx)("textarea",{name:"issueNotes",defaultValue:m?m.issueNotes:""})]}),Object(H.jsxs)("label",{children:["Service Notes",Object(H.jsx)("textarea",{name:"serviceNotes",defaultValue:m?m.serviceNotes:""})]})]}),Object(H.jsxs)("div",{className:"button-area",children:[Object(H.jsx)("button",{className:"btn-form",type:"submit",children:"Save"}),Object(H.jsx)("button",{className:"btn-form",onClick:function(){"/customers"===window.location.pathname?(e.setQueryData("selectedJob",null),e.setQueryData("view","customerForm")):(e.setQueryData("selectedCustomer",null),e.setQueryData("selectedJob",null),e.setQueryData("view","default"))},children:"Cancel"}),m&&m._id?Object(H.jsx)("button",{className:"btn-form delete",onClick:function(){var t;"requests"===h?g(m._id):(t=m._id,window.confirm("Are you sure you want to delete?\nThis cannot be undone.")&&p.mutate(t),n("Job Deleted")),e.setQueryData("selectedCustomer",null),e.setQueryData("selectedJob",null),e.setQueryData("view","default")},children:"Delete"}):Object(H.jsx)(H.Fragment,{})]})]})})}},he=(s(110),function(){var e=L().user,t=T(),s=t.status,c=t.data,r=t.error,a=V(),n=a.status,i=a.data,u=a.error,o=k(),l=o.status,d=o.data,j=o.error,b=F(),m=b.status,h=b.data,O=b.error,x=I("view");if(!e)return Object(H.jsx)(U.a,{to:"/login"});switch(l||s||n||m){case"loading":return Object(H.jsx)("h1",{className:"text-center",children:"Loading"});case"error":return Object(H.jsxs)("h4",{className:"text-center",children:["Error: ",j.message," | ",r.message," | ",u.message," | ",O.message]});default:return"messages"===x?Object(H.jsxs)("main",{className:"container",id:"dashboard",children:[Object(H.jsx)(te,{}),Object(H.jsx)(ae,{messages:c.data})]}):"serviceForm"===x?Object(H.jsxs)("main",{className:"container",id:"dashboard",children:[Object(H.jsx)(te,{}),Object(H.jsx)(me,{})]}):Object(H.jsxs)("main",{className:"container",id:"dashboard",children:[Object(H.jsx)(te,{}),Object(H.jsxs)("div",{className:"dashboard-top",children:[Object(H.jsx)(ie,{jobs:"success"===l?d.data.filter((function(e){return"Pending"===e.status})):[],requests:"success"===n?i.data:[],messages:"success"===s?c.data.filter((function(e){return!e.read})):[],parts:"success"===m?h.data.filter((function(e){return e.stock<e.minimum})):[]}),Object(H.jsx)(ue,{jobs:d.data.filter((function(e){return"Completed"===e.status}))})]}),Object(H.jsx)(ne,{jobs:d.data})]})}}),Oe=(s(111),function(){var e=L().user,t=k(),s=t.status,c=t.data,r=t.error,a=V(),n=a.status,i=a.data,u=a.error,o=I("view");if(!e)return Object(H.jsx)(U.a,{to:"/login"});switch(s||n){case"loading":return Object(H.jsx)("h1",{className:"text-center",children:"Loading"});case"error":return Object(H.jsxs)("h4",{className:"text-center",children:["Error: ",r.message," ",u.message]});default:return"serviceForm"===o?Object(H.jsxs)("main",{className:"container",children:[Object(H.jsx)(oe,{}),Object(H.jsx)(me,{})]}):"requests"===o?Object(H.jsxs)("main",{className:"container",children:[Object(H.jsx)(oe,{}),Object(H.jsx)(je,{requests:i.data})]}):"unpaid"===o?Object(H.jsxs)("main",{className:"container",children:[Object(H.jsx)(oe,{}),Object(H.jsx)(be,{jobs:c.data})]}):Object(H.jsxs)("main",{className:"container",children:[Object(H.jsx)(oe,{}),Object(H.jsx)(de,{jobs:c.data})]})}}),xe=function(){var e=Object(u.useQueryClient)(),t=I("view");return Object(H.jsxs)("div",{className:"main-header",children:[Object(H.jsx)("h1",{onClick:function(){e.setQueryData("view","default")},children:"Customers"}),Object(H.jsxs)("div",{className:"button-area",children:[Object(H.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","default")},children:"View All"}),Object(H.jsx)("p",{className:"btn",onClick:function(){if(e.setQueryData("submissionType","new"),e.setQueryData("selectedCustomer",null),"customerForm"===t){var s,c=document.querySelectorAll("input, textarea"),r=Object(B.a)(c);try{for(r.s();!(s=r.n()).done;){s.value.value=""}}catch(a){r.e(a)}finally{r.f()}}else e.setQueryData("view","customerForm")},children:"Create New"})]})]})},fe=function(e){var t=e.customers,s=Object(u.useQueryClient)(),r=Object(c.useState)([]),a=Object(P.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(""),l=Object(P.a)(o,2),d=l[0],j=l[1];return Object(c.useEffect)((function(){i(""!==d?t.filter((function(e){return e.businessName.toLowerCase().includes(d.toLowerCase())||e.address.city.toLowerCase().includes(d.toLowerCase())||e.phone.includes(d)})):t)}),[d,t]),Object(H.jsxs)("section",{children:[Object(H.jsx)("div",{className:"section-header",children:Object(H.jsx)("div",{children:Object(H.jsx)(G,{placeholder:"Search",setSearch:j})})}),Object(H.jsxs)("table",{children:[Object(H.jsx)("thead",{children:Object(H.jsxs)("tr",{className:"tr-customer",children:[Object(H.jsx)("th",{children:"Business Name"}),Object(H.jsx)("th",{children:"Address"}),Object(H.jsx)("th",{className:"text-center",children:"Contact"}),Object(H.jsx)("th",{className:"text-center",children:"Phone #"})]})}),Object(H.jsx)("tbody",{children:n.map((function(e){return Object(H.jsxs)("tr",{className:"table-item tr-customer clickable",onClick:function(){s.setQueryData("submissionType","edit"),s.setQueryData("selectedCustomer",e),s.setQueryData("view","customerForm")},children:[Object(H.jsx)("td",{children:e.businessName}),Object(H.jsxs)("td",{children:[e.address.street1,""!==e.address.street2?", "+e.address.street2+", ":", ",e.address.city,", ",e.address.state," ",e.address.zipcode]}),Object(H.jsx)("td",{className:"text-center",children:e.contactName?e.contactName:"--"}),Object(H.jsx)("td",{className:"text-center",children:e.phone})]},e._id)}))})]}),n.length<1?Object(H.jsx)("p",{className:"empty",children:"** No customers to display **"}):Object(H.jsx)(H.Fragment,{})]})},pe=function(){var e=Object(u.useQueryClient)(),t=A().addToast,s=I("selectedCustomer"),c=I("submissionType"),r=Object(u.useMutation)((function(e){return w.createCustomer(e)}),{onSuccess:function(){e.invalidateQueries("customers")}}),a=Object(u.useMutation)((function(e){return w.updateCustomer(e.id,e.data)}),{onSuccess:function(){e.invalidateQueries("customers"),e.invalidateQueries("jobs")}}),n=Object(u.useMutation)((function(e){return w.deleteCustomer(e)}),{onSuccess:function(){e.invalidateQueries("customers")}}),i=Object(u.useMutation)((function(e){return w.deleteJobsByCustomerId(e)}),{onSuccess:function(){e.invalidateQueries("jobs")}}),o=function(){var c=Object(d.a)(l.a.mark((function c(){return l.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!window.confirm("Are you sure you want to delete?\nThis will delete the customer and their service history from the database.\nThis cannot be undone.")){c.next=7;break}return c.next=4,n.mutate(s._id);case 4:i.mutate(s._id),e.setQueryData("selectedCustomer",null),e.setQueryData("view","default");case 7:t("Customer Deleted");case 8:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}(),j=function(){var t=Object(d.a)(l.a.mark((function t(n){var i,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.preventDefault(),i=Object.fromEntries(new FormData(n.target)),u={businessName:i.businessName.trim(),contactName:i.contactName.trim(),phone:i.phone.trim(),address:{street1:i.street1.trim(),street2:i.street2.trim(),city:i.city.trim(),state:i.state.trim(),zipcode:i.zipcode.trim()},notes:i.notes.trim()},"edit"!==c){t.next=8;break}return a.mutate({id:s._id,data:u}),e.setQueryData("view","default"),t.abrupt("return");case 8:if("new"!==c){t.next=12;break}return t.next=11,r.mutateAsync(u);case 11:e.setQueryData("view","default");case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.error(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}();return Object(H.jsx)("section",{children:Object(H.jsxs)("form",{id:"form-customer",onSubmit:j,children:[Object(H.jsxs)("div",{className:"customer-area",children:[Object(H.jsx)("div",{children:Object(H.jsxs)("label",{children:["Contact Information",Object(H.jsx)("input",{type:"text",name:"businessName",placeholder:"Business Name",required:!0,defaultValue:s?s.businessName:""}),Object(H.jsx)("input",{type:"text",name:"contactName",placeholder:"Contact Person",defaultValue:s?s.contactName:""}),Object(H.jsx)("input",{type:"text",name:"phone",placeholder:"Phone #",required:!0,defaultValue:s?s.phone:""})]})}),Object(H.jsx)("div",{children:Object(H.jsxs)("label",{className:"address",children:["Address",Object(H.jsx)("input",{type:"text",name:"street1",placeholder:"Street Address",required:!0,defaultValue:s?s.address.street1:""}),Object(H.jsx)("input",{type:"text",name:"street2",placeholder:"Unit or Building #",defaultValue:s?s.address.street2:""}),Object(H.jsxs)("div",{children:[Object(H.jsx)("input",{type:"text",name:"city",placeholder:"City",required:!0,defaultValue:s?s.address.city:""}),Object(H.jsx)("input",{className:"text-center",type:"text",name:"state",defaultValue:"CA",required:!0}),Object(H.jsx)("input",{type:"text",name:"zipcode",placeholder:"Zip Code",required:!0,defaultValue:s?s.address.zipcode:""})]})]})})]}),Object(H.jsx)("div",{className:"notes-area",children:Object(H.jsxs)("label",{children:["Notes",Object(H.jsx)("textarea",{name:"notes",defaultValue:s?s.notes:""})]})}),Object(H.jsxs)("div",{className:"button-area",children:[Object(H.jsx)("button",{className:"btn-form",type:"submit",children:"Save"}),Object(H.jsx)("button",{className:"btn-form",onClick:function(){e.setQueryData("selectedCustomer",null),e.setQueryData("view","default")},children:"Cancel"}),s&&s._id?Object(H.jsx)("button",{className:"btn-form delete",onClick:o,children:"Delete"}):Object(H.jsx)(H.Fragment,{})]})]})})},ve=function(e){var t=e.jobs,s=e.customerId,r=Object(u.useQueryClient)(),a=Object(c.useState)([]),n=Object(P.a)(a,2),i=n[0],o=n[1];return Object(c.useEffect)((function(){var e=t.filter((function(e){return e.customer._id===s&&"Completed"===e.status}));o(e)}),[s,t]),Object(H.jsxs)("section",{className:"customer-history",children:[Object(H.jsx)("h2",{children:"Service History"}),Object(H.jsxs)("table",{children:[Object(H.jsx)("thead",{children:Object(H.jsxs)("tr",{className:"tr-history",children:[Object(H.jsx)("th",{className:"text-center",children:"Date Completed"}),Object(H.jsx)("th",{children:"Service Notes"})]})}),Object(H.jsx)("tbody",{className:"tbody-history",children:i.map((function(e){return Object(H.jsxs)("tr",{className:"table-item clickable tr-history",onClick:function(){r.setQueryData("submissionType","edit"),r.setQueryData("selectedJob",e),r.setQueryData("view","serviceForm")},children:[Object(H.jsx)("td",{className:"text-center",children:e.serviceDate?re()(e.serviceDate).format("MMM DD YYYY"):"--"}),Object(H.jsx)("td",{children:e.serviceNotes?e.serviceNotes:""})]},e._id)}))})]}),i.length<1?Object(H.jsx)("p",{className:"empty",children:"** No job history to display **"}):Object(H.jsx)(H.Fragment,{})]})},ye=(s(112),function(){var e=L().user,t=D(),s=t.status,c=t.data,r=t.error,a=k(),n=a.status,i=a.data,u=a.error,o=I("selectedCustomer"),l=I("view");if(!e)return Object(H.jsx)(U.a,{to:"/login"});switch(s||n){case"loading":return Object(H.jsx)("h1",{className:"text-center",children:"Loading"});case"error":return Object(H.jsxs)("h4",{className:"text-center",children:["Error: ",r.message," ",u.message]});default:return"customerForm"===l?Object(H.jsxs)("main",{className:"container",children:[Object(H.jsx)(xe,{}),Object(H.jsx)(pe,{}),o?Object(H.jsx)(ve,{jobs:i.data,customerId:o._id}):Object(H.jsx)(H.Fragment,{})]}):"serviceForm"===l?Object(H.jsxs)("main",{className:"container",children:[Object(H.jsx)(xe,{}),Object(H.jsx)(me,{})]}):Object(H.jsxs)("main",{className:"container",children:[Object(H.jsx)(xe,{}),Object(H.jsx)(fe,{customers:c.data})]})}}),Ne=function(){var e=Object(u.useQueryClient)();return Object(H.jsxs)("div",{className:"main-header",children:[Object(H.jsx)("h1",{onClick:function(){e.setQueryData("view","default")},children:"Inventory"}),Object(H.jsxs)("div",{className:"button-area",children:[Object(H.jsx)("p",{className:"btn",onClick:function(){e.refetchQueries("parts"),e.setQueryData("view","default")},children:"View All"}),Object(H.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("view","restock")},children:"View Low Stock"}),Object(H.jsx)("p",{className:"btn",onClick:function(){e.setQueryData("submissionType","new"),e.setQueryData("view","newPart")},children:"Create New"})]})]})},ge=function(e){var t=e.parts,s=Object(u.useQueryClient)(),r=Object(c.useState)([]),a=Object(P.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(""),l=Object(P.a)(o,2),d=l[0],j=l[1];Object(c.useEffect)((function(){i(""!==d?t.filter((function(e){return e.partNumber.toLowerCase().includes(d.toLowerCase())||e.description.toLowerCase().includes(d.toLowerCase())})):t)}),[d,t]);var b=Object(u.useMutation)((function(e){return w.updatePart(e.id,e.data)}),{onSuccess:function(){s.invalidateQueries("parts")}}),m=function(e,t){"+"===e.target.innerHTML?b.mutate({id:t._id,data:Object(se.a)(Object(se.a)({},t),{},{stock:t.stock+1})}):b.mutate({id:t._id,data:Object(se.a)(Object(se.a)({},t),{},{stock:t.stock-1})})};return Object(H.jsxs)("section",{children:[Object(H.jsx)("div",{className:"section-header",children:Object(H.jsx)("div",{children:Object(H.jsx)(G,{placeholder:"Search",setSearch:j})})}),Object(H.jsxs)("table",{children:[Object(H.jsx)("thead",{children:Object(H.jsxs)("tr",{className:"tr-part",children:[Object(H.jsx)("th",{children:"Part #"}),Object(H.jsx)("th",{children:"Description"}),Object(H.jsx)("th",{className:"text-center",children:"In Stock"}),Object(H.jsx)("th",{className:"text-center",children:"Change Quantity"}),Object(H.jsx)("th",{className:"text-center",children:"Edit"})]})}),Object(H.jsx)("tbody",{children:n.map((function(e){return Object(H.jsxs)("tr",{className:"table-item tr-part",id:e._id,children:[Object(H.jsx)("td",{children:e.partNumber}),Object(H.jsx)("td",{children:e.description}),Object(H.jsx)("td",{className:"text-center ".concat(e.stock<e.minimum?"red bold":""),children:e.stock}),Object(H.jsxs)("td",{className:"inventory-buttons",children:[Object(H.jsx)("div",{className:"quantity",onClick:function(t){return m(t,e)},children:"+"}),Object(H.jsx)("div",{className:"quantity",onClick:function(t){return m(t,e)},children:"\u2212"})]}),Object(H.jsx)("td",{className:"inventory-buttons",children:Object(H.jsx)("div",{className:"select",onClick:function(){s.setQueryData("submissionType","edit"),s.setQueryData("selectedPart",e),s.setQueryData("view","newPart")},children:Object(H.jsx)(R.a,{icon:z.c})})})]},e._id)}))})]}),n.length<1?Object(H.jsx)("p",{className:"empty",children:"** No parts to display **"}):Object(H.jsx)(H.Fragment,{})]})},we=function(e){var t=e.parts,s=Object(u.useQueryClient)(),r=Object(c.useState)(t),a=Object(P.a)(r,2),n=a[0],i=a[1],o=Object(c.useState)(""),l=Object(P.a)(o,2),d=(l[0],l[1]);Object(c.useEffect)((function(){i(t.filter((function(e){return e.stock<e.minimum})))}),[t]);Object(u.useMutation)((function(e){return w.updatePart(e.id,e.data)}),{onSuccess:function(){s.invalidateQueries("parts")}});return Object(H.jsxs)("section",{children:[Object(H.jsx)("div",{className:"section-header",children:Object(H.jsx)("div",{children:Object(H.jsx)(G,{placeholder:"Search",setSearch:d})})}),Object(H.jsxs)("table",{children:[Object(H.jsx)("thead",{children:Object(H.jsxs)("tr",{className:"tr-restock",children:[Object(H.jsx)("th",{children:"Part #"}),Object(H.jsx)("th",{children:"Description"}),Object(H.jsx)("th",{className:"text-center",children:"In Stock"}),Object(H.jsx)("th",{})]})}),Object(H.jsx)("tbody",{children:n.map((function(e){return Object(H.jsxs)("tr",{className:"table-item tr-restock",id:e._id,children:[Object(H.jsx)("td",{children:e.partNumber}),Object(H.jsx)("td",{children:e.description}),Object(H.jsx)("td",{className:"text-center",children:e.stock}),Object(H.jsx)("td",{children:Object(H.jsxs)("p",{className:"warning",children:["desired minimum: ",e.minimum]})})]},e._id)}))})]}),n.length<1?Object(H.jsx)("p",{className:"empty",children:"** No parts to display **"}):Object(H.jsx)(H.Fragment,{})]})},Ce=function(){var e=Object(u.useQueryClient)(),t=A().addToast,s=I("selectedPart"),c=I("submissionType"),r=Object(u.useMutation)((function(e){return w.createPart(e)}),{onSuccess:function(){e.invalidateQueries("parts")}}),a=Object(u.useMutation)((function(e){return w.updatePart(e.id,e.data)}),{onSuccess:function(){e.invalidateQueries("parts")}}),n=Object(u.useMutation)((function(e){return w.deletePart(e)}),{onSuccess:function(){e.invalidateQueries("parts")}}),i=function(){var t=Object(d.a)(l.a.mark((function t(n){var i,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.preventDefault(),i=Object.fromEntries(new FormData(n.target)),u={partNumber:i.partNumber.toUpperCase().trim(),description:i.description.trim(),stock:parseInt(i.stock),minimum:parseInt(i.minimum)},"edit"!==c){t.next=9;break}return t.next=7,a.mutate({id:s._id,data:u});case 7:return e.setQueryData("showPartForm",!1),t.abrupt("return");case 9:if("new"!==c){t.next=13;break}return t.next=12,r.mutate(u);case 12:e.setQueryData("showPartForm",!1);case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),console.error(t.t0);case 18:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}();return Object(H.jsx)("section",{children:Object(H.jsxs)("form",{id:"form-part",onSubmit:i,children:[Object(H.jsxs)("div",{children:[Object(H.jsxs)("label",{className:"text-center",children:["Part #",Object(H.jsx)("input",{className:"text-center",type:"text",name:"partNumber",placeholder:"Part #",defaultValue:s?s.partNumber:""})]}),Object(H.jsxs)("label",{children:["Description",Object(H.jsx)("input",{type:"text",name:"description",placeholder:"Description",defaultValue:s?s.description:""})]}),Object(H.jsxs)("label",{className:"text-center",children:["In Stock",Object(H.jsx)("input",{className:"text-center",type:"text",name:"stock",placeholder:"#",defaultValue:s?s.stock:""})]})]}),Object(H.jsx)("div",{children:Object(H.jsxs)("label",{className:"stock-notification",children:["Notify me when stock drops below:",Object(H.jsx)("input",{className:"text-center",type:"text",name:"minimum",placeholder:"#",defaultValue:s?s.minimum:""})]})}),Object(H.jsxs)("div",{className:"button-area",children:[Object(H.jsx)("button",{className:"btn-form",type:"submit",children:"Save"}),Object(H.jsx)("button",{className:"btn-form",onClick:function(){e.removeQueries("selectedPart"),e.setQueryData("view","inventory")},children:"Cancel"}),s&&s._id?Object(H.jsx)("button",{className:"btn-form delete",onClick:function(){var c;c=s._id,window.confirm("Are you sure you want to delete?\nThis cannot be undone.")&&n.mutate(c),t("Part Deleted"),e.removeQueries("selectedCustomer"),e.removeQueries("selectedJob"),e.setQueryData("view","inventory")},children:"Delete"}):Object(H.jsx)(H.Fragment,{})]})]})})},De=(s(113),function(){var e=L().user,t=F(),s=t.status,c=t.data,r=t.error,a=(t.isFetching,I("view"));if(!e)return Object(H.jsx)(U.a,{to:"/login"});switch(s){case"loading":return Object(H.jsx)("h1",{className:"text-center",children:"Loading"});case"error":return Object(H.jsxs)("h4",{className:"text-center",children:["Error: ",r.message]});default:return"restock"===a?Object(H.jsxs)("main",{className:"container",children:[Object(H.jsx)(Ne,{}),Object(H.jsx)(we,{parts:c.data})]}):"newPart"===a?Object(H.jsxs)("main",{className:"container",children:[Object(H.jsx)(Ne,{}),Object(H.jsx)(Ce,{})]}):Object(H.jsxs)("main",{className:"container",children:[Object(H.jsx)(Ne,{}),Object(H.jsx)(ge,{parts:c.data})]})}}),Qe=function(){return Object(H.jsx)(X.a,{children:Object(H.jsxs)(U.d,{children:[Object(H.jsx)(U.b,{exact:!0,path:"/",component:K}),Object(H.jsx)(U.b,{exact:!0,path:"/login",component:K}),Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)($,{}),Object(H.jsx)(U.b,{exact:!0,path:"/register",component:ee}),Object(H.jsx)(U.b,{exact:!0,path:"/dashboard",component:he}),Object(H.jsx)(U.b,{exact:!0,path:"/customers",component:ye}),Object(H.jsx)(U.b,{exact:!0,path:"/service",component:Oe}),Object(H.jsx)(U.b,{exact:!0,path:"/inventory",component:De})]})]})})},ke=(s(114),function(){return Object(H.jsxs)(u.QueryClientProvider,{client:Y,children:[Object(H.jsx)(Qe,{}),Object(H.jsx)(W,{}),Object(H.jsx)(i.ReactQueryDevtools,{})]})});n.a.render(Object(H.jsx)(r.a.StrictMode,{children:Object(H.jsx)(ke,{})}),document.getElementById("root"))},99:function(e,t,s){}},[[115,1,2]]]);
//# sourceMappingURL=main.30feb862.chunk.js.map